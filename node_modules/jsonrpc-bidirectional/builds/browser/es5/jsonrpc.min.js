/**
jsonrpc-bidirectional v5.1.1
Bidirectional JSONRPC over web sockets or HTTP with extensive plugin support.
https://github.com/oxygen/jsonrpc-bidirectional


MIT License

Copyright (c) 2017 Bigstep Cloud SRL

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require(""),require("fetch"));else if("function"==typeof define&&define.amd)define(["","fetch"],t);else{var r="object"==typeof exports?t(require(""),require("fetch")):t(e[""],e.fetch);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(e,t){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=52)}([function(e,t,r){"use strict";(function(t){function n(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0}function o(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}function i(e){return Object.prototype.toString.call(e)}function s(e){return!o(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}function a(e){if(w.isFunction(e)){if(k)return e.name;var t=e.toString(),r=t.match(O);return r&&r[1]}}function u(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function c(e){if(k||!w.isFunction(e))return w.inspect(e);var t=a(e);return"[Function"+(t?": "+t:"")+"]"}function f(e){return u(c(e.actual),128)+" "+e.operator+" "+u(c(e.expected),128)}function l(e,t,r,n,o){throw new S.AssertionError({message:r,actual:e,expected:t,operator:n,stackStartFunction:o})}function p(e,t){e||l(e,!0,t,"==",S.ok)}function h(e,t,r,a){if(e===t)return!0;if(o(e)&&o(t))return 0===n(e,t);if(w.isDate(e)&&w.isDate(t))return e.getTime()===t.getTime();if(w.isRegExp(e)&&w.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(s(e)&&s(t)&&i(e)===i(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===n(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(o(e)!==o(t))return!1;a=a||{actual:[],expected:[]};var u=a.actual.indexOf(e);return-1!==u&&u===a.expected.indexOf(t)||(a.actual.push(e),a.expected.push(t),d(e,t,r,a))}return r?e===t:e==t}function b(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function d(e,t,r,n){if(null===e||void 0===e||null===t||void 0===t)return!1;if(w.isPrimitive(e)||w.isPrimitive(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var o=b(e),i=b(t);if(o&&!i||!o&&i)return!1;if(o)return e=_.call(e),t=_.call(t),h(e,t,r);var s,a,u=P(e),c=P(t);if(u.length!==c.length)return!1;for(u.sort(),c.sort(),a=u.length-1;a>=0;a--)if(u[a]!==c[a])return!1;for(a=u.length-1;a>=0;a--)if(s=u[a],!h(e[s],t[s],r,n))return!1;return!0}function y(e,t,r){h(e,t,!0)&&l(e,t,r,"notDeepStrictEqual",y)}function v(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function g(e){var t;try{e()}catch(e){t=e}return t}function m(e,t,r,n){var o;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),o=g(t),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),e&&!o&&l(o,r,"Missing expected exception"+n);var i="string"==typeof n,s=!e&&w.isError(o),a=!e&&o&&!r;if((s&&i&&v(o,r)||a)&&l(o,r,"Got unwanted exception"+n),e&&o&&r&&!v(o,r)||!e&&o)throw o}var w=r(47),R=Object.prototype.hasOwnProperty,_=Array.prototype.slice,k=function(){return"foo"===function(){}.name}(),S=e.exports=p,O=/\s*function\s+([^\(\s]*)\s*/;S.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=f(this),this.generatedMessage=!0);var t=e.stackStartFunction||l;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var r=new Error;if(r.stack){var n=r.stack,o=a(t),i=n.indexOf("\n"+o);if(i>=0){var s=n.indexOf("\n",i+1);n=n.substring(s+1)}this.stack=n}}},w.inherits(S.AssertionError,Error),S.fail=l,S.ok=p,S.equal=function(e,t,r){e!=t&&l(e,t,r,"==",S.equal)},S.notEqual=function(e,t,r){e==t&&l(e,t,r,"!=",S.notEqual)},S.deepEqual=function(e,t,r){h(e,t,!1)||l(e,t,r,"deepEqual",S.deepEqual)},S.deepStrictEqual=function(e,t,r){h(e,t,!0)||l(e,t,r,"deepStrictEqual",S.deepStrictEqual)},S.notDeepEqual=function(e,t,r){h(e,t,!1)&&l(e,t,r,"notDeepEqual",S.notDeepEqual)},S.notDeepStrictEqual=y,S.strictEqual=function(e,t,r){e!==t&&l(e,t,r,"===",S.strictEqual)},S.notStrictEqual=function(e,t,r){e===t&&l(e,t,r,"!==",S.notStrictEqual)},S.throws=function(e,t,r){m(!0,e,t,r)},S.doesNotThrow=function(e,t,r){m(!1,e,t,r)},S.ifError=function(e){if(e)throw e};var P=Object.keys||function(e){var t=[];for(var r in e)R.call(e,r)&&t.push(r);return t}}).call(t,r(14))},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(35);e.exports=function(e){function Exception(e,t){n(this,Exception);var r=o(this,(Exception.__proto__||Object.getPrototypeOf(Exception)).call(this,e));return r.strMessage=e,r.nCode=t,r}return i(Exception,e),s(Exception,[{key:"code",get:function(){return this.nCode}}],[{key:"NOT_AUTHENTICATED",get:function(){return-1}},{key:"NOT_AUTHORIZED",get:function(){return-2}},{key:"REQUEST_EXPIRED",get:function(){return-3}},{key:"NETWORK_ERROR",get:function(){return-4}},{key:"PARSE_ERROR",get:function(){return-32700}},{key:"INVALID_REQUEST",get:function(){return-32600}},{key:"METHOD_NOT_FOUND",get:function(){return-32601}},{key:"INVALID_PARAMS",get:function(){return-32602}},{key:"INTERNAL_ERROR",get:function(){return-32603}}]),Exception}(a)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.Exception=r(1),e.exports=function(){function Utils(){n(this,Utils),Object.seal(this)}return o(Utils,null,[{key:"jsonDecodeSafe",value:function(e){try{return JSON.parse(e)}catch(t){throw new JSONRPC.Exception(t.message+"; RAW JSON string: "+JSON.stringify(e),JSONRPC.Exception.PARSE_ERROR)}}}]),Utils}()},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(f===setTimeout)return setTimeout(e,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function i(e){if(l===clearTimeout)return clearTimeout(e);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function s(){d&&h&&(d=!1,h.length?b=h.concat(b):y=-1,b.length&&a())}function a(){if(!d){var e=o(s);d=!0;for(var t=b.length;t;){for(h=b,b=[];++y<t;)h&&h[y].run();y=-1,t=b.length}h=null,d=!1,i(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var f,l,p=e.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(e){f=r}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(e){l=n}}();var h,b=[],d=!1,y=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];b.push(new u(e,t)),1!==b.length||d||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e.exports=function(){function ClientPluginBase(){o(this,ClientPluginBase)}return i(ClientPluginBase,[{key:"beforeJSONEncode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterJSONEncode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"makeRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"beforeJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"exceptionCatch",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()}]),ClientPluginBase}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(43),a=r(0);e.exports=function(){function EndpointBase(e,t,r,i){n(this,EndpointBase),a.strictEqual(void 0===e?"undefined":o(e),"string"),a.strictEqual(void 0===t?"undefined":o(t),"string"),a.strictEqual(void 0===r?"undefined":o(r),"object"),this._strName=e,this._strPath=EndpointBase.normalizePath(t),this._objReflection=r,this._classReverseCallsClient=i}return i(EndpointBase,[{key:"path",get:function(){return this._strPath}},{key:"name",get:function(){return this._strName}},{key:"reflection",get:function(){return this._objReflection}},{key:"ReverseCallsClientClass",get:function(){return this._classReverseCallsClient}}],[{key:"normalizePath",value:function(e){var t=s.parse(e).pathname.trim();return t.length&&"/"===t.substr(-1)||(t+="/"),"/"!==t.substr(0,1)&&(t="/"+t),t}}]),EndpointBase}()},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.Exception=r(1),JSONRPC.IncomingRequest=r(10),JSONRPC.Utils=r(2),JSONRPC.EndpointBase=r(5);var c=r(13),f=r(0);e.exports=function(e){function Server(){o(this,Server);var e=i(this,(Server.__proto__||Object.getPrototypeOf(Server)).call(this));return e._arrPlugins=[],e._objEndpoints={},Object.seal(e),e}return s(Server,e),u(Server,[{key:"attachToHTTPServer",value:function(){function e(e,r,n){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t,r,o){var i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=!!o,f("string"==typeof r,"strRootPath must be of type string, received "+(void 0===r?"undefined":a(r))),r=JSONRPC.EndpointBase.normalizePath(r),t.on("request",function(){var e=n(regeneratorRuntime.mark(function e(t,n){var s,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=JSONRPC.EndpointBase.normalizePath(t.url),s.substr(0,r.length)===r){e.next=3;break}return e.abrupt("return");case 3:if(!t.headers["sec-websocket-version"]){e.next=10;break}if(!o){e.next=6;break}return e.abrupt("return");case 6:return console.error("Received websocket upgrade request, yet not sharing the HTTP connection with a WebSocket."),n.statusCode=403,n.end(),e.abrupt("return");case 10:return e.prev=10,n.statusCode=500,e.next=14,i.processHTTPRequest(t,n);case 14:return a=e.sent,e.next=17,i.processRequest(a);case 17:a.callResult instanceof Error?n.statusCode=500:a.isNotification?n.statusCode=204:n.statusCode=200,a.isNotification||(n.setHeader("Content-Type","application/json"),n.write(a.callResultSerialized)),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(10),console.error(e.t0);case 24:n.end();case 25:case"end":return e.stop()}},e,i,[[10,21]])}));return function(t,r){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"registerEndpoint",value:function(e){if(this._objEndpoints.hasOwnProperty(e.path)){if(this._objEndpoints[e.path]!==e)throw new Error("Another JSONRPC endpoint is registered at the same path: "+e.path)}else this._objEndpoints[e.path]=e}},{key:"unregisterEndpoint",value:function(e){if(this._objEndpoints.hasOwnProperty(e))return delete this._objEndpoints[e],!0}},{key:"addPlugin",value:function(e){this._arrPlugins.includes(e)||this._arrPlugins.push(e)}},{key:"removePlugin",value:function(e){this._arrPlugins.includes(e)&&this._arrPlugins.splice(this._arrPlugins.findIndex(function(t){return e===t}),1)}},{key:"processHTTPRequest",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){var o,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=new JSONRPC.IncomingRequest,e.prev=1,"POST"!==r.method){e.next=9;break}return i=[],e.next=6,new Promise(function(e,o){r.on("error",o),n.on("error",o),r.on("end",function(){e(t.concat(i).toString())}),r.on("data",function(e){i.push(e)})});case 6:o.requestBody=e.sent,e.next=10;break;case 9:throw new Error("JSONRPC does not handle HTTP "+r.method+" requests.");case 10:if(o.headers=r.headers,o.remoteAddress=r.socket.remoteAddress,s=JSONRPC.EndpointBase.normalizePath(r.url),this._objEndpoints.hasOwnProperty(s)){e.next=15;break}throw new JSONRPC.Exception("Unknown JSONRPC endpoint "+s+".",JSONRPC.Exception.METHOD_NOT_FOUND);case 15:o.endpoint=this._objEndpoints[s],e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),o.callResult=e.t0;case 21:return e.abrupt("return",o);case 22:case"end":return e.stop()}},e,this,[[1,18]])}));return e}()},{key:"processRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r,n,o,i,s,u,c,f,l,p,h,b,d,y,v,g,m,w,R,_,k,S,O,P,E,x,j,C,A,T,q,B,N,U,W,D,I,L,M,J,H,z;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.isMethodCalled){e.next=108;break}this.emit("beforeJSONDecode",t),r=!0,n=!1,o=void 0,e.prev=6,i=this._arrPlugins[Symbol.iterator]();case 8:if(r=(s=i.next()).done){e.next=15;break}return u=s.value,e.next=12,u.beforeJSONDecode(t);case 12:r=!0,e.next=8;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(6),n=!0,o=e.t0;case 21:e.prev=21,e.prev=22,!r&&i.return&&i.return();case 24:if(e.prev=24,!n){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(21);case 29:t.requestObject||(t.requestObject=JSONRPC.Utils.jsonDecodeSafe(t.requestBody)),this.emit("afterJSONDecode",t),c=!0,f=!1,l=void 0,e.prev=34,p=this._arrPlugins[Symbol.iterator]();case 36:if(c=(h=p.next()).done){e.next=43;break}return b=h.value,e.next=40,b.afterJSONDecode(t);case 40:c=!0,e.next=36;break;case 43:e.next=49;break;case 45:e.prev=45,e.t1=e.catch(34),f=!0,l=e.t1;case 49:e.prev=49,e.prev=50,!c&&p.return&&p.return();case 52:if(e.prev=52,!f){e.next=55;break}throw l;case 55:return e.finish(52);case 56:return e.finish(49);case 57:if(!Array.isArray(t.requestObject)){e.next=59;break}throw new JSONRPC.Exception("Batch requests are not supported by this JSON-RPC server.",JSONRPC.Exception.INTERNAL_ERROR);case 59:if(t.requestObject.hasOwnProperty("params")){e.next=63;break}t.requestObject.params=[],e.next=69;break;case 63:if(Array.isArray(t.requestObject.params)){e.next=69;break}if("object"!==a(t.requestObject.params)){e.next=68;break}throw new JSONRPC.Exception("Named params are not supported by this server.",JSONRPC.Exception.INTERNAL_ERROR);case 68:throw new JSONRPC.Exception("The params property has invalid data type, per JSON-RPC 2.0 specification. Unexpected type: "+a(t.requestObject.params)+".",JSONRPC.Exception.INVALID_REQUEST);case 69:if(t.isAuthenticated){e.next=71;break}throw new JSONRPC.Exception("Not authenticated.",JSONRPC.Exception.NOT_AUTHENTICATED);case 71:if(t.isAuthorized){e.next=73;break}throw new JSONRPC.Exception("Not authorized.",JSONRPC.Exception.NOT_AUTHORIZED);case 73:t.isMethodCalled||this.emit("callFunction",t),d=!0,y=!1,v=void 0,e.prev=77,g=this._arrPlugins[Symbol.iterator]();case 79:if(d=(m=g.next()).done){e.next=88;break}if(w=m.value,!t.isMethodCalled){e.next=83;break}return e.abrupt("break",88);case 83:return e.next=85,w.callFunction(t);case 85:d=!0,e.next=79;break;case 88:e.next=94;break;case 90:e.prev=90,e.t2=e.catch(77),y=!0,v=e.t2;case 94:e.prev=94,e.prev=95,!d&&g.return&&g.return();case 97:if(e.prev=97,!y){e.next=100;break}throw v;case 100:return e.finish(97);case 101:return e.finish(94);case 102:if(t.isMethodCalled){e.next=108;break}if("function"==typeof t.endpoint[t.requestObject.method]){e.next=105;break}throw new JSONRPC.Exception("Method "+JSON.stringify(t.requestObject.method)+" not found on endpoint "+JSON.stringify(t.endpoint.path)+".",JSONRPC.Exception.METHOD_NOT_FOUND);case 105:return e.next=107,t.endpoint[t.requestObject.method].apply(t.endpoint,[t].concat(t.requestObject.params));case 107:t.callResult=e.sent;case 108:e.next=113;break;case 110:e.prev=110,e.t3=e.catch(0),t.callResult=e.t3;case 113:if(!(t.callResult instanceof Error)){e.next=143;break}this.emit("exceptionCatch",t),R=!0,_=!1,k=void 0,e.prev=118,S=this._arrPlugins[Symbol.iterator]();case 120:if(R=(O=S.next()).done){e.next=127;break}return P=O.value,e.next=124,P.exceptionCatch(t);case 124:R=!0,e.next=120;break;case 127:e.next=133;break;case 129:e.prev=129,e.t4=e.catch(118),_=!0,k=e.t4;case 133:e.prev=133,e.prev=134,!R&&S.return&&S.return();case 136:if(e.prev=136,!_){e.next=139;break}throw k;case 139:return e.finish(136);case 140:return e.finish(133);case 141:e.next=170;break;case 143:this.emit("result",t),E=!0,x=!1,j=void 0,e.prev=147,C=this._arrPlugins[Symbol.iterator]();case 149:if(E=(A=C.next()).done){e.next=156;break}return T=A.value,e.next=153,T.result(t);case 153:E=!0,e.next=149;break;case 156:e.next=162;break;case 158:e.prev=158,e.t5=e.catch(147),x=!0,j=e.t5;case 162:e.prev=162,e.prev=163,!E&&C.return&&C.return();case 165:if(e.prev=165,!x){e.next=168;break}throw j;case 168:return e.finish(165);case 169:return e.finish(162);case 170:t.callResultToBeSerialized=t.toResponseObject(),this.emit("response",t),q=!0,B=!1,N=void 0,e.prev=175,U=this._arrPlugins[Symbol.iterator]();case 177:if(q=(W=U.next()).done){e.next=184;break}return D=W.value,e.next=181,D.response(t);case 181:q=!0,e.next=177;break;case 184:e.next=190;break;case 186:e.prev=186,e.t6=e.catch(175),B=!0,N=e.t6;case 190:e.prev=190,e.prev=191,!q&&U.return&&U.return();case 193:if(e.prev=193,!B){e.next=196;break}throw N;case 196:return e.finish(193);case 197:return e.finish(190);case 198:null===t.callResultSerialized&&(t.callResultSerialized=JSON.stringify(t.callResultToBeSerialized,void 0,"\t")),this.emit("afterSerialize",t),I=!0,L=!1,M=void 0,e.prev=203,J=this._arrPlugins[Symbol.iterator]();case 205:if(I=(H=J.next()).done){e.next=212;break}return z=H.value,e.next=209,z.afterSerialize(t);case 209:I=!0,e.next=205;break;case 212:e.next=218;break;case 214:e.prev=214,e.t7=e.catch(203),L=!0,M=e.t7;case 218:e.prev=218,e.prev=219,!I&&J.return&&J.return();case 221:if(e.prev=221,!L){e.next=224;break}throw M;case 224:return e.finish(221);case 225:return e.finish(218);case 226:case"end":return e.stop()}},e,this,[[0,110],[6,17,21,29],[22,,24,28],[34,45,49,57],[50,,52,56],[77,90,94,102],[95,,97,101],[118,129,133,141],[134,,136,140],[147,158,162,170],[163,,165,169],[175,186,190,198],[191,,193,197],[203,214,218,226],[219,,221,225]])}));return e}()},{key:"endpoints",get:function(){return this._objEndpoints}}]),Server}(c)}).call(t,r(16).Buffer)},function(e,t,r){"use strict";var n={};n.DebugLogger=r(22),n.PrettyBrowserConsoleErrors=r(23),n.SignatureAdd=r(25),n.WebSocketTransport=r(27),n.WorkerTransport=r(28),n.ProcessStdIOTransport=r(24),n.WebRTCTransport=r(26),e.exports=n},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),JSONRPC=r(9);JSONRPC.Server=r(6);var c=r(13);e.exports=function(e){function RouterBase(e){n(this,RouterBase);var t=o(this,(RouterBase.__proto__||Object.getPrototypeOf(RouterBase)).call(this));return u(null===e||e instanceof JSONRPC.Server,"jsonrpcServer must be either null or an instance or subclass of JSONRPC.Server."),t._jsonrpcServer=e,t._nConnectionIDCounter=0,t._objSessions={},t}return i(RouterBase,e),a(RouterBase,[{key:"connectionIDToSingletonClient",value:function(e,t){if(u("number"==typeof e,"nConnectionID must be a number. Received this: "+JSON.stringify(e)),u("function"==typeof t,"Invalid ClientClass value: "+(void 0===t?"undefined":s(t))),!this._objSessions.hasOwnProperty(e))throw new Error("Connection "+JSON.stringify(e)+" not found in router.");return null===this._objSessions[e].clientReverseCalls?this._objSessions[e].clientReverseCalls=this._makeReverseCallsClient(t,this._objSessions[e]):u(this._objSessions[e].clientReverseCalls instanceof t,"clientReverseCalls already initialized with a different JSONRPC.Client subclass."),this._objSessions[e].clientReverseCalls}},{key:"onConnectionEnded",value:function(e){delete this._objSessions[e]}},{key:"_makeReverseCallsClient",value:function(e,t){throw new Error("Must implement.")}}]),RouterBase}(c)},function(e,t,r){var n={};n.Client=r(15),n.ClientPluginBase=r(4),n.Utils=r(2),n.Exception=r(1),n.EndpointBase=r(5),n.Server=r(6),n.ServerPluginBase=r(11),n.BidirectionalWebsocketRouter=r(19),n.BidirectionalWorkerRouter=r(20),n.BidirectionalWebRTCRouter=r(18),n.RouterBase=r(8),n.Plugins=n.Plugins||{},n.Plugins.Client=r(7),n.Plugins.Server=r(32),n.WebSocketAdapters=n.WebSocketAdapters||{},n.WebSocketAdapters.WebSocketWrapperBase=r(12),n.WebSocketAdapters.uws=n.WebSocketAdapters.uws||{},n.WebSocketAdapters.uws.WebSocketWrapper=r(33),e.exports=n},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),JSONRPC={};JSONRPC.EndpointBase=r(5),JSONRPC.Exception=r(1),JSONRPC.Server=r(6),JSONRPC.RouterBase=r(8),e.exports=function(){function e(){n(this,e),this._bAuthenticated=!1,this._bAuthorized=!1,this._mxRequestBody=null,this._requestObject=null,this._endpoint=null,this._router=null,this._mxResult=null,this._objResponseToBeSerialized=null,this._mxResultSerialized=null,this._bMethodCalled=!1,this._nConnectionID=null,this._classClient=null,this._objHeaders={},this._strRemoteAddress="",Object.seal(this)}return i(e,[{key:"toResponseObject",value:function(){var e={id:null,jsonrpc:"2.0"};return this.callResult instanceof Error?e.error={message:this.callResult.message,code:this.callResult instanceof JSONRPC.Exception?this.callResult.code:0,data:this.callResult.stack.split(/[\r\n]+/gm)}:e.result=void 0===this.callResult?null:this.callResult,null!==this._requestObject&&"object"===o(this._requestObject)&&this._requestObject.hasOwnProperty("id")&&(e.id=this._requestObject.id),e}},{key:"isAuthenticated",get:function(){return this._bAuthenticated},set:function(e){s("boolean"==typeof e,"bAuthenticated must be of type boolean."),this._bAuthenticated=e}},{key:"connectionID",get:function(){return this._nConnectionID},set:function(e){s("number"==typeof e&&parseInt(e,10)===e,"Connection ID must be an integer."),this._nConnectionID=e}},{key:"isAuthorized",get:function(){return this._bAuthorized},set:function(e){s("boolean"==typeof e,"bAuthorized must be of type boolean."),this._bAuthorized=e}},{key:"requestBody",get:function(){return this._mxRequestBody},set:function(e){this._mxRequestBody=e}},{key:"requestObject",get:function(){return this._requestObject},set:function(e){s("object"===(void 0===e?"undefined":o(e))||Array.isArray(e),"objRequest must be of type Array or Object."),this._requestObject=e}},{key:"isNotification",get:function(){return null!==this._requestObject&&"object"===o(this._requestObject)&&!this.requestObject.hasOwnProperty("id")}},{key:"endpoint",get:function(){return this._endpoint},set:function(e){s(e instanceof JSONRPC.EndpointBase,"endpoint must extend JSONRPC.EndpointBase"),this._endpoint=e}},{key:"router",set:function(e){s(e instanceof JSONRPC.RouterBase,"router must extend JSONRPC.RouterBase."),this._router=e}},{key:"reverseCallsClient",get:function(){return null===this._classClient&&null!==this.connectionID&&this.endpoint&&this.endpoint.ReverseCallsClientClass&&(this._classClient=this._router.connectionIDToSingletonClient(this.connectionID,this.endpoint.ReverseCallsClientClass)),this._classClient}},{key:"isMethodCalled",get:function(){return this._bMethodCalled},set:function(e){s("boolean"==typeof e,"bMethodCalled must be of type boolean."),this._bMethodCalled=e}},{key:"callResult",get:function(){return this._mxResult},set:function(e){this.isMethodCalled=!0,this._mxResult=e}},{key:"callResultToBeSerialized",get:function(){return this._objResponseToBeSerialized},set:function(e){this._objResponseToBeSerialized=e}},{key:"callResultSerialized",get:function(){return this._mxResultSerialized},set:function(e){this._mxResultSerialized=e}},{key:"headers",get:function(){return this._objHeaders},set:function(e){this._objHeaders=e}},{key:"remoteAddress",get:function(){return this._strRemoteAddress},set:function(e){this._strRemoteAddress=e}}]),e}()},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e.exports=function(){function ServerPluginBase(){o(this,ServerPluginBase)}return i(ServerPluginBase,[{key:"beforeJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"callFunction",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"result",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"exceptionCatch",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"response",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterSerialize",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()}]),ServerPluginBase}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var s=o.get;if(void 0!==s)return s.call(n)},u=r(13);e.exports=function(e){function WebSocketWrapperBase(e,t){n(this,WebSocketWrapperBase);var r=o(this,(WebSocketWrapperBase.__proto__||Object.getPrototypeOf(WebSocketWrapperBase)).call(this));return r._webSocket=e,r}return i(WebSocketWrapperBase,e),s(WebSocketWrapperBase,[{key:"on",value:function(e,t){return this._webSocket.on(e,t)}},{key:"superOn",value:function(e,t){return a(WebSocketWrapperBase.prototype.__proto__||Object.getPrototypeOf(WebSocketWrapperBase.prototype),"on",this).call(this,e,t)}},{key:"send",value:function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return(t=this._webSocket).send.apply(t,[e].concat(n))}},{key:"close",value:function(e,t){return this._webSocket.close(e,t)}},{key:"terminate",value:function(){return this._webSocket.terminate()}},{key:"ping",value:function(){var e;return(e=this._webSocket).ping.apply(e,arguments)}},{key:"pong",value:function(){var e;return(e=this._webSocket).pong.apply(e,arguments)}},{key:"url",get:function(){return this._webSocket.url}},{key:"socket",get:function(){return this._webSocket.socket}},{key:"readyState",get:function(){return this._webSocket.readyState}},{key:"protocol",get:function(){return this._webSocket.protocol}},{key:"protocolVersion",get:function(){return this._webSocket.protocolVersion}}],[{key:"CONNECTING",get:function(){return 0}},{key:"OPEN",get:function(){return 1}},{key:"CLOSING",get:function(){return 2}},{key:"CLOSED",get:function(){return 3}}]),WebSocketWrapperBase}(u)},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function o(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,o,a,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}if(r=this._events[e],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(i(r))for(a=Array.prototype.slice.call(arguments,1),c=r.slice(),o=c.length,u=0;u<o;u++)c[u].apply(this,a);return!0},r.prototype.addListener=function(e,t){var o;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(o=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),o||(o=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var o=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,o,s,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],s=r.length,o=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(a=s;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){o=a;break}if(o<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.Exception=r(1),JSONRPC.Plugins={},JSONRPC.Plugins.Client=r(7),JSONRPC.Utils=r(2),JSONRPC.OutgoingRequest=r(21);var u=r(13),c=r(50),f=r(0);e.exports=function(e){function Client(e){o(this,Client);var t=i(this,(Client.__proto__||Object.getPrototypeOf(Client)).call(this));return t._arrPlugins=[],t._strJSONRPCEndpointURL=e,t._nCallID=1,t._strHTTPUser=null,t._strHTTPPassword=null,t._strBase64BasicAuthentication=null,t}return s(Client,e),a(Client,[{key:"setHTTPCredentials",value:function(e,r){this._strHTTPUser=e,this._strHTTPPassword=r,this._strBase64BasicAuthentication=new t(e+":"+r).toString("base64")}},{key:"rpc",value:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t,r){var n,o,i,s,a,u,l,p,h,b,d,y,v,g,m,w,R,_,k,S,O,P,E,x,j,C,A,T,q,B,N,U,W,D,I,L,M,J,H,z;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:f(Array.isArray(r),"arrParams must be an Array."),n=new JSONRPC.OutgoingRequest(t,r,this._nCallID),this._nCallID++,e.prev=3,n.endpointURL=this.endpointURL,n.headers["Content-Type"]="application/json",null!==this.httpUser&&null!==this.httpPassword&&(n.headers.Authorization="Basic "+this._strBase64BasicAuthentication),n.requestObject=n.toRequestObject(),this.emit("beforeJSONEncode",n),o=!0,i=!1,s=void 0,e.prev=12,a=this._arrPlugins[Symbol.iterator]();case 14:if(o=(u=a.next()).done){e.next=21;break}return l=u.value,e.next=18,l.beforeJSONEncode(n);case 18:o=!0,e.next=14;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(12),i=!0,s=e.t0;case 27:e.prev=27,e.prev=28,!o&&a.return&&a.return();case 30:if(e.prev=30,!i){e.next=33;break}throw s;case 33:return e.finish(30);case 34:return e.finish(27);case 35:null===n.requestBody&&(n.requestBody=JSON.stringify(n.requestObject,null,"\t")),this.emit("afterJSONEncode",n),p=!0,h=!1,b=void 0,e.prev=40,d=this._arrPlugins[Symbol.iterator]();case 42:if(p=(y=d.next()).done){e.next=49;break}return v=y.value,e.next=46,v.afterJSONEncode(n);case 46:p=!0,e.next=42;break;case 49:e.next=55;break;case 51:e.prev=51,e.t1=e.catch(40),h=!0,b=e.t1;case 55:e.prev=55,e.prev=56,!p&&d.return&&d.return();case 58:if(e.prev=58,!h){e.next=61;break}throw b;case 61:return e.finish(58);case 62:return e.finish(55);case 63:n.isMethodCalled||this.emit("makeRequest",n),g=!0,m=!1,w=void 0,e.prev=67,R=this._arrPlugins[Symbol.iterator]();case 69:if(g=(_=R.next()).done){e.next=78;break}if(k=_.value,!n.isMethodCalled){e.next=73;break}return e.abrupt("break",78);case 73:return e.next=75,k.makeRequest(n);case 75:g=!0,e.next=69;break;case 78:e.next=84;break;case 80:e.prev=80,e.t2=e.catch(67),m=!0,w=e.t2;case 84:e.prev=84,e.prev=85,!g&&R.return&&R.return();case 87:if(e.prev=87,!m){e.next=90;break}throw w;case 90:return e.finish(87);case 91:return e.finish(84);case 92:if(S=null,O=!1,n.isMethodCalled){e.next=108;break}return P=new(c.Request?c.Request:Request)(n.endpointURL,{method:"POST",mode:"cors",headers:new(c.Headers?c.Headers:Headers)(n.headers),body:n.requestBody,cache:"no-cache",credentials:"include"}),e.next=98,c(P);case 98:if(S=e.sent,O=!S.ok,S.ok||0!==parseInt(S.status,10)){e.next=105;break}n.responseObject={jsonrpc:Client.JSONRPC_VERSION,error:{code:JSONRPC.Exception.NETWORK_ERROR,message:"Network error. The internet connection may have failed."},id:n.callID},n.responseBody=JSON.stringify(n.responseObject,void 0,"\t"),e.next=108;break;case 105:return e.next=107,S.text();case 107:n.responseBody=e.sent;case 108:this.emit("beforeJSONDecode",n),E=!0,x=!1,j=void 0,e.prev=112,C=this._arrPlugins[Symbol.iterator]();case 114:if(E=(A=C.next()).done){e.next=121;break}return T=A.value,e.next=118,T.beforeJSONDecode(n);case 118:E=!0,e.next=114;break;case 121:e.next=127;break;case 123:e.prev=123,e.t3=e.catch(112),x=!0,j=e.t3;case 127:e.prev=127,e.prev=128,!E&&C.return&&C.return();case 130:if(e.prev=130,!x){e.next=133;break}throw j;case 133:return e.finish(130);case 134:return e.finish(127);case 135:null===n.responseObject&&(n.responseObject=JSONRPC.Utils.jsonDecodeSafe(n.responseBody)),this.emit("afterJSONDecode",n),q=!0,B=!1,N=void 0,e.prev=140,U=this._arrPlugins[Symbol.iterator]();case 142:if(q=(W=U.next()).done){e.next=149;break}return D=W.value,e.next=146,D.afterJSONDecode(n);case 146:q=!0,e.next=142;break;case 149:e.next=155;break;case 151:e.prev=151,e.t4=e.catch(140),B=!0,N=e.t4;case 155:e.prev=155,e.prev=156,!q&&U.return&&U.return();case 158:if(e.prev=158,!B){e.next=161;break}throw N;case 161:return e.finish(158);case 162:return e.finish(155);case 163:n.responseObject.hasOwnProperty("error")?n.responseObject.error.hasOwnProperty("message")&&"string"==typeof n.responseObject.error.message&&n.responseObject.error.hasOwnProperty("code")&&"number"==typeof n.responseObject.error.code?n.callResult=new JSONRPC.Exception(n.responseObject.error.message,n.responseObject.error.code):n.callResult=new JSONRPC.Exception("Invalid error object on JSONRPC protocol response. Response: "+JSON.stringify(n.responseObject),JSONRPC.Exception.INTERNAL_ERROR):n.responseObject.hasOwnProperty("result")?n.callResult=n.responseObject.result:O=!0,!O||n.callResult instanceof Error||(n.callResult=new JSONRPC.Exception("Invalid error object on JSONRPC protocol response. Response object: "+JSON.stringify(n.responseObject)+". HTTP response class instance: "+JSON.stringify(S)+".",JSONRPC.Exception.INTERNAL_ERROR)),e.next=170;break;case 167:e.prev=167,e.t5=e.catch(3),n.callResult=e.t5;case 170:if(!(n.callResult instanceof Error)){e.next=199;break}this.emit("exceptionCatch",n),I=!0,L=!1,M=void 0,e.prev=175,J=this._arrPlugins[Symbol.iterator]();case 177:if(I=(H=J.next()).done){e.next=184;break}return z=H.value,e.next=181,z.exceptionCatch(n);case 181:I=!0,e.next=177;break;case 184:e.next=190;break;case 186:e.prev=186,e.t6=e.catch(175),L=!0,M=e.t6;case 190:e.prev=190,e.prev=191,!I&&J.return&&J.return();case 193:if(e.prev=193,!L){e.next=196;break}throw M;case 196:return e.finish(193);case 197:return e.finish(190);case 198:throw n.callResult;case 199:return e.abrupt("return",n.callResult);case 200:case"end":return e.stop()}},e,this,[[3,167],[12,23,27,35],[28,,30,34],[40,51,55,63],[56,,58,62],[67,80,84,92],[85,,87,91],[112,123,127,135],[128,,130,134],[140,151,155,163],[156,,158,162],[175,186,190,198],[191,,193,197]])}));return e}()},{key:"addPlugin",value:function(e){this._arrPlugins.includes(e)||this._arrPlugins.push(e)}},{key:"removePlugin",value:function(e){this._arrPlugins.includes(e)&&this._arrPlugins.splice(this._arrPlugins.findIndex(function(t){return e===t}),1)}},{key:"rpcFunctions",value:function(){return this.rpc("rpc.functions",[].slice.call(arguments))}},{key:"rpcReflectionFunction",value:function(e){return this.rpc("rpc.reflectionFunction",[e])}},{key:"rpcReflectionFunctions",value:function(e){return this.rpc("rpc.reflectionFunctions",[e])}},{key:"rpcAllowedCrossSiteXHRSubdomains",value:function(){return this.rpc("rpc.allowedCrossSiteXHRSubdomains",[])}},{key:"enableLogging",value:function(){this._consoleLoggerPlugin||(this._consoleLoggerPlugin=new JSONRPC.Plugins.Client.DebugLogger),this.addPlugin(this._consoleLoggerPlugin)}},{key:"disableLogging",value:function(){this._consoleLoggerPlugin&&this.removePlugin(this._consoleLoggerPlugin)}},{key:"endpointURL",get:function(){return this._strJSONRPCEndpointURL}},{key:"plugins",get:function(){return this._arrPlugins}},{key:"callID",get:function(){return this._nCallID}},{key:"httpUser",get:function(){return this._strHTTPUser}},{key:"httpPassword",get:function(){return this._strHTTPPassword}}],[{key:"JSONRPC_VERSION",get:function(){return"2.0"}}]),Client}(u)}).call(t,r(16).Buffer)},function(e,t,r){"use strict";(function(e){function n(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=i.prototype):(null===e&&(e=new i(t)),e.length=t),e}function i(e,t,r){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return s(this,e,t,r)}function s(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?p(e,t,r,n):"string"==typeof t?f(e,t,r):h(e,t)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,r,n){return a(t),t<=0?o(e,t):void 0!==r?"string"==typeof n?o(e,t).fill(r,n):o(e,t).fill(r):o(e,t)}function c(e,t){if(a(t),e=o(e,t<0?0:0|b(t)),!i.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function f(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!i.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|y(t,r);e=o(e,n);var s=e.write(t,r);return s!==n&&(e=e.slice(0,s)),e}function l(e,t){var r=t.length<0?0:0|b(t.length);e=o(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function p(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),i.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=i.prototype):e=l(e,t),e}function h(e,t){if(i.isBuffer(t)){var r=0|b(t.length);return e=o(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||V(t.length)?o(e,0):l(e,t);if("Buffer"===t.type&&G(t.data))return l(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function b(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function d(e){return+e!=e&&(e=0),i.alloc(+e)}function y(e,t){if(i.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return K(e).length;default:if(n)return z(e).length;t=(""+t).toLowerCase(),n=!0}}function v(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,r);case"utf8":case"utf-8":return x(this,t,r);case"ascii":return C(this,t,r);case"latin1":case"binary":return A(this,t,r);case"base64":return E(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=i.from(t,n)),i.isBuffer(t))return 0===t.length?-1:w(e,t,r,n,o);if("number"==typeof t)return t&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,n,o){function i(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}var c;if(o){var f=-1;for(c=r;c<a;c++)if(i(e,c)===i(t,-1===f?0:c-f)){if(-1===f&&(f=c),c-f+1===u)return f*s}else-1!==f&&(c-=c-f),f=-1}else for(r+u>a&&(r=a-u),c=r;c>=0;c--){for(var l=!0,p=0;p<u;p++)if(i(e,c+p)!==i(t,p)){l=!1;break}if(l)return c}return-1}function R(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function _(e,t,r,n){return X(z(t,e.length-r),e,r,n)}function k(e,t,r,n){return X(F(t),e,r,n)}function S(e,t,r,n){return k(e,t,r,n)}function O(e,t,r,n){return X(K(t),e,r,n)}function P(e,t,r,n){return X(Y(t,e.length-r),e,r,n)}function E(e,t,r){return 0===t&&r===e.length?Z.fromByteArray(e):Z.fromByteArray(e.slice(t,r))}function x(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i=e[o],s=null,a=i>239?4:i>223?3:i>191?2:1;if(o+a<=r){var u,c,f,l;switch(a){case 1:i<128&&(s=i);break;case 2:u=e[o+1],128==(192&u)&&(l=(31&i)<<6|63&u)>127&&(s=l);break;case 3:u=e[o+1],c=e[o+2],128==(192&u)&&128==(192&c)&&(l=(15&i)<<12|(63&u)<<6|63&c)>2047&&(l<55296||l>57343)&&(s=l);break;case 4:u=e[o+1],c=e[o+2],f=e[o+3],128==(192&u)&&128==(192&c)&&128==(192&f)&&(l=(15&i)<<18|(63&u)<<12|(63&c)<<6|63&f)>65535&&l<1114112&&(s=l)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),o+=a}return j(n)}function j(e){var t=e.length;if(t<=Q)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Q));return r}function C(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function T(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=H(e[i]);return o}function q(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function B(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,r,n,o,s){if(!i.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function U(e,t,r,n){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-r,2);o<i;++o)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function W(e,t,r,n){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-r,4);o<i;++o)e[r+o]=t>>>8*(n?o:3-o)&255}function D(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function I(e,t,r,n,o){return o||D(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),$.write(e,t,r,n,23,4),r+4}function L(e,t,r,n,o){return o||D(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),$.write(e,t,r,n,52,8),r+8}function M(e){if(e=J(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function J(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e,t){t=t||1/0;for(var r,n=e.length,o=null,i=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function F(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function Y(e,t){for(var r,n,o,i=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,o=r%256,i.push(o),i.push(n);return i}function K(e){return Z.toByteArray(M(e))}function X(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function V(e){return e!==e}var Z=r(34),$=r(36),G=r(37);t.Buffer=i,t.SlowBuffer=d,t.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=n(),i.poolSize=8192,i._augment=function(e){return e.__proto__=i.prototype,e},i.from=function(e,t,r){return s(null,e,t,r)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(e,t,r){return u(null,e,t,r)},i.allocUnsafe=function(e){return c(null,e)},i.allocUnsafeSlow=function(e){return c(null,e)},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.compare=function(e,t){if(!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,o=0,s=Math.min(r,n);o<s;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!G(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return i.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=i.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var s=e[r];if(!i.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o),o+=s.length}return n},i.byteLength=y,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},i.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},i.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},i.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):v.apply(this,arguments)},i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===i.compare(this,e)},i.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},i.prototype.compare=function(e,t,r,n,o){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,o>>>=0,this===e)return 0;for(var s=o-n,a=r-t,u=Math.min(s,a),c=this.slice(n,o),f=e.slice(t,r),l=0;l<u;++l)if(c[l]!==f[l]){s=c[l],a=f[l];break}return s<a?-1:a<s?1:0},i.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},i.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},i.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},i.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return R(this,e,t,r);case"utf8":case"utf-8":return _(this,e,t,r);case"ascii":return k(this,e,t,r);case"latin1":case"binary":return S(this,e,t,r);case"base64":return O(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;i.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n;if(i.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=i.prototype;else{var o=t-e;n=new i(o,void 0);for(var s=0;s<o;++s)n[s]=this[s+e]}return n},i.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},i.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},i.prototype.readUInt8=function(e,t){return t||B(e,1,this.length),this[e]},i.prototype.readUInt16LE=function(e,t){return t||B(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUInt16BE=function(e,t){return t||B(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUInt32LE=function(e,t){return t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},i.prototype.readUInt32BE=function(e,t){return t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n},i.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||B(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},i.prototype.readInt8=function(e,t){return t||B(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){t||B(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt16BE=function(e,t){t||B(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt32LE=function(e,t){return t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readFloatLE=function(e,t){return t||B(e,4,this.length),$.read(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return t||B(e,4,this.length),$.read(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return t||B(e,8,this.length),$.read(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return t||B(e,8,this.length),$.read(this,e,!1,52,8)},i.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){N(this,e,t,r,Math.pow(2,8*r)-1,0)}var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},i.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){N(this,e,t,r,Math.pow(2,8*r)-1,0)}var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},i.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,1,255,0),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},i.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},i.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},i.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):W(this,e,t,!0),t+4},i.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):W(this,e,t,!1),t+4},i.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);N(this,e,t,r,o-1,-o)}var i=0,s=1,a=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},i.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);N(this,e,t,r,o-1,-o)}var i=r-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},i.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,1,127,-128),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},i.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},i.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},i.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):W(this,e,t,!0),t+4},i.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):W(this,e,t,!1),t+4},i.prototype.writeFloatLE=function(e,t,r){return I(this,e,t,!0,r)},i.prototype.writeFloatBE=function(e,t,r){return I(this,e,t,!1,r)},i.prototype.writeDoubleLE=function(e,t,r){return L(this,e,t,!0,r)},i.prototype.writeDoubleBE=function(e,t,r){return L(this,e,t,!1,r)},i.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o,s=n-r;if(this===e&&r<t&&t<n)for(o=s-1;o>=0;--o)e[o+t]=this[o+r];else if(s<1e3||!i.TYPED_ARRAY_SUPPORT)for(o=0;o<s;++o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+s),t);return s},i.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!i.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var s;if("number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{var a=i.isBuffer(e)?e:z(new i(e,n).toString()),u=a.length;for(s=0;s<r-t;++s)this[s+t]=a[s%u]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,r(14))},function(e,t,r){e.exports={JSONRPC:r(9)}},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC=r(9);JSONRPC.Exception=r(1),JSONRPC.Server=r(6),JSONRPC.IncomingRequest=r(10),JSONRPC.EndpointBase=r(5),JSONRPC.RouterBase=r(8),JSONRPC.Plugins={},JSONRPC.Plugins.Client=r(7),JSONRPC.Utils=r(2),e.exports=function(e){function BidirectionalWebRTCRouter(){return o(this,BidirectionalWebRTCRouter),i(this,(BidirectionalWebRTCRouter.__proto__||Object.getPrototypeOf(BidirectionalWebRTCRouter)).apply(this,arguments))}return s(BidirectionalWebRTCRouter,e),a(BidirectionalWebRTCRouter,[{key:"addRTCDataChannelSync",value:function(e){var r=this;if("closed"===e.readyState)return void console.log("["+t.pid+"] addRTCDataChannelSync ignoring closed dataChannel.");var o=++this._nConnectionIDCounter,i=JSONRPC.EndpointBase.normalizePath(e.label),s={dataChannel:e,nConnectionID:o,clientReverseCalls:null,clientWebRTCTransportPlugin:null,strEndpointPath:i};return this._objSessions[o]=s,e.addEventListener("message",function(){var e=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._routeMessage(t.data,s);case 2:case"end":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}()),e.addEventListener("close",function(e){r.onConnectionEnded(o)}),e.addEventListener("error",function(t){console.error(t),r.onConnectionEnded(o),"open"===e.readyState&&e.close()}),o}},{key:"_makeReverseCallsClient",value:function(e,t){var r=new e(t.strEndpointPath);return t.clientWebRTCTransportPlugin=new JSONRPC.Plugins.Client.WebRTCTransport(t.dataChannel,!0),r.addPlugin(t.clientWebRTCTransportPlugin),this.emit("madeReverseCallsClient",r),r}},{key:"_routeMessage",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){var o,i,s,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.dataChannel,i=n.nConnectionID,r.trim().length){e.next=5;break}return console.log("["+t.pid+"] WebRTCBidirectionalRouter: Received empty message. Ignoring."),e.abrupt("return");case 5:s=void 0,e.prev=6,s=JSONRPC.Utils.jsonDecodeSafe(r),e.next=18;break;case 10:return e.prev=10,e.t0=e.catch(6),console.error(e.t0),console.error("Unable to parse JSON. RAW remote message: "+r),this._jsonrpcServer&&this._objSessions.hasOwnProperty(i)&&null===this._objSessions[i].clientWebRTCTransportPlugin&&"open"===o.readyState&&o.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"Invalid JSON: "+JSON.stringify(r)+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),console.log("["+t.pid+"] Unclean state. Unable to match RTCDataChannel message to an existing Promise or qualify it as a request or response."),"open"===o.readyState&&o.close(),e.abrupt("return");case 18:if(e.prev=18,!s.hasOwnProperty("method")){e.next=44;break}if(this._jsonrpcServer){e.next=23;break}throw"open"===o.readyState&&o.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"JSONRPC.Server not initialized on this RTCDataChannel. Raw request: "+r+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),new Error("JSONRPC.Server not initialized on this RTCDataChannel.");case 23:if(a=new JSONRPC.IncomingRequest,a.connectionID=i,a.router=this,e.prev=26,u=this._objSessions[i].strEndpointPath,this._jsonrpcServer.endpoints.hasOwnProperty(u)){e.next=30;break}throw new JSONRPC.Exception("Unknown JSONRPC endpoint "+u+".",JSONRPC.Exception.METHOD_NOT_FOUND);case 30:a.endpoint=this._jsonrpcServer.endpoints[u],a.requestBody=r,a.requestObject=s,e.next=38;break;case 35:e.prev=35,e.t1=e.catch(26),a.callResult=e.t1;case 38:return e.next=40,this._jsonrpcServer.processRequest(a);case 40:"open"!==o.readyState&&console.error("dataChannel.readyState: "+JSON.stringify(o.readyState)+". Request was "+r+". Attempted responding with "+JSON.stringify(a.callResultToBeSerialized,void 0,"\t")+"."),o.send(a.callResultSerialized),e.next=58;break;case 44:if(!s.hasOwnProperty("result")&&!s.hasOwnProperty("error")){e.next=57;break}if(!this._objSessions.hasOwnProperty(i)||null!==this._objSessions[i].clientWebRTCTransportPlugin){e.next=49;break}throw this._jsonrpcServer||"open"===o.readyState&&o.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"JSONRPC.Client not initialized on this RTCConnection. Raw message: "+r+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),"open"===o.readyState&&o.close(),new Error("How can the client be not initialized, and yet getting responses from phantom requests?");case 49:if(!this._objSessions.hasOwnProperty(i)){e.next=54;break}return e.next=52,this._objSessions[i].clientWebRTCTransportPlugin.processResponse(r,s);case 52:e.next=55;break;case 54:console.error("Connection ID "+i+" is closed and session is missing. Ignoring response: "+r);case 55:e.next=58;break;case 57:throw new Error("Unable to qualify the message as a JSONRPC request or response.");case 58:e.next=67;break;case 60:return e.prev=60,e.t2=e.catch(18),console.error(e.t2),console.error("Uncaught error. RAW remote message: "+r),this._jsonrpcServer&&this._objSessions.hasOwnProperty(i)&&null===this._objSessions[i].clientWebRTCTransportPlugin&&"open"===o.readyState&&o.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"Internal error: "+e.t2.message+".",code:JSONRPC.Exception.INTERNAL_ERROR}},void 0,"\t")),"open"===o.readyState&&(console.log("["+t.pid+"] Unclean state. Closing data channel."),o.close()),e.abrupt("return");case 67:case"end":return e.stop()}},e,this,[[6,10],[18,60],[26,35]])}));return e}()}]),BidirectionalWebRTCRouter}(JSONRPC.RouterBase)}).call(t,r(3))},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC=r(9);JSONRPC.Exception=r(1),JSONRPC.Server=r(6),JSONRPC.IncomingRequest=r(10),JSONRPC.EndpointBase=r(5),JSONRPC.RouterBase=r(8),JSONRPC.Plugins={},JSONRPC.Plugins.Client=r(7),JSONRPC.Utils=r(2),JSONRPC.WebSocketAdapters={},JSONRPC.WebSocketAdapters.WebSocketWrapperBase=r(12),e.exports=function(e){function BidirectionalWebsocketRouter(){return o(this,BidirectionalWebsocketRouter),i(this,(BidirectionalWebsocketRouter.__proto__||Object.getPrototypeOf(BidirectionalWebsocketRouter)).apply(this,arguments))}return s(BidirectionalWebsocketRouter,e),a(BidirectionalWebsocketRouter,[{key:"addWebSocketSync",value:function(e){var r=this;if(e.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.CLOSED)return void console.log("["+t.pid+"] addWebSocketSync ignoring closed webSocket.");var n=++this._nConnectionIDCounter,o=JSONRPC.EndpointBase.normalizePath(e.url?e.url:e.upgradeReq.url),i={webSocket:e,nConnectionID:n,clientReverseCalls:null,clientWebSocketTransportPlugin:null,strEndpointPath:o};this._objSessions[n]=i;var s=function(t){r.onConnectionEnded(n),e.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&e.close(1e3,t.message)};if(e.on)e.on("message",function(e,t){r._routeMessage(e,i)}),e.on("close",function(e,t){r.onConnectionEnded(n)}),e.on("error",s);else{if(!e.addEventListener)throw new Error("Not a supported WebSocket interface.");e.addEventListener("message",function(e){r._routeMessage(e.data,i)}),e.addEventListener("close",function(e){r.onConnectionEnded(n)}),e.addEventListener("error",s)}return n}},{key:"_makeReverseCallsClient",value:function(e,t){var r=new e(t.strEndpointPath);return t.clientWebSocketTransportPlugin=new JSONRPC.Plugins.Client.WebSocketTransport(t.webSocket,!0),r.addPlugin(t.clientWebSocketTransportPlugin),this.emit("madeReverseCallsClient",r),r}},{key:"_routeMessage",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){var o,i,s,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.webSocket,i=n.nConnectionID,r.trim().length){e.next=5;break}return console.log("["+t.pid+"] WebSocketBidirectionalRouter: Received empty message. Ignoring."),e.abrupt("return");case 5:s=void 0,e.prev=6,s=JSONRPC.Utils.jsonDecodeSafe(r),e.next=18;break;case 10:return e.prev=10,e.t0=e.catch(6),console.error(e.t0),console.error("Unable to parse JSON. RAW remote message: "+r),this._jsonrpcServer&&this._objSessions.hasOwnProperty(i)&&null===this._objSessions[i].clientWebSocketTransportPlugin&&o.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&o.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"Invalid JSON: "+JSON.stringify(r)+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),console.log("["+t.pid+"] Unclean state. Unable to match WebSocket message to an existing Promise or qualify it as a request or response."),o.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&o.close(1e3,"Unclean state. Unable to match WebSocket message to an existing Promise or qualify it as a request or response."),e.abrupt("return");case 18:if(e.prev=18,!s.hasOwnProperty("method")){e.next=45;break}if(this._jsonrpcServer){e.next=23;break}throw o.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&o.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"JSONRPC.Server not initialized on this WebSocket. Raw request: "+r+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),new Error("JSONRPC.Server not initialized on this WebSocket");case 23:if(a=new JSONRPC.IncomingRequest,a.connectionID=i,a.router=this,o.upgradeReq&&(a.headers=o.upgradeReq.headers,a.remoteAddress=o.upgradeReq.socket.remoteAddress),e.prev=27,u=this._objSessions[i].strEndpointPath,this._jsonrpcServer.endpoints.hasOwnProperty(u)){e.next=31;break}throw new JSONRPC.Exception("Unknown JSONRPC endpoint "+u+".",JSONRPC.Exception.METHOD_NOT_FOUND);case 31:a.endpoint=this._jsonrpcServer.endpoints[u],a.requestBody=r,a.requestObject=s,e.next=39;break;case 36:e.prev=36,e.t1=e.catch(27),a.callResult=e.t1;case 39:return e.next=41,this._jsonrpcServer.processRequest(a);case 41:o.readyState!==JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&console.error("webSocket.readyState: "+JSON.stringify(o.readyState)+". Request was "+r+". Attempted responding with "+JSON.stringify(a.callResultToBeSerialized,void 0,"\t")+"."),o.send(a.callResultSerialized),e.next=59;break;case 45:if(!s.hasOwnProperty("result")&&!s.hasOwnProperty("error")){e.next=58;break}if(!this._objSessions.hasOwnProperty(i)||null!==this._objSessions[i].clientWebSocketTransportPlugin){e.next=50;break}throw this._jsonrpcServer||o.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&o.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"JSONRPC.Client not initialized on this WebSocket. Raw message: "+r+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),o.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&o.close(1e3,"How can the client be not initialized, and yet getting responses from phantom requests? Closing websocket."),new Error("How can the client be not initialized, and yet getting responses from phantom requests?");case 50:if(!this._objSessions.hasOwnProperty(i)){e.next=55;break}return e.next=53,this._objSessions[i].clientWebSocketTransportPlugin.processResponse(r,s);case 53:e.next=56;break;case 55:console.error("Connection ID "+i+" is closed and session is missing. Ignoring response: "+r);case 56:e.next=59;break;case 58:throw new Error("Unable to qualify the message as a JSONRPC request or response.");case 59:e.next=68;break;case 61:return e.prev=61,e.t2=e.catch(18),console.error(e.t2),console.error("Uncaught error. RAW remote message: "+r),this._jsonrpcServer&&this._objSessions.hasOwnProperty(i)&&null===this._objSessions[i].clientWebSocketTransportPlugin&&o.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&o.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"Internal error: "+e.t2.message+".",code:JSONRPC.Exception.INTERNAL_ERROR}},void 0,"\t")),o.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&(console.log("["+t.pid+"] Unclean state. Closing websocket."),o.close(1e3,"Unclean state. Closing websocket.")),e.abrupt("return");case 68:case"end":return e.stop()}},e,this,[[6,10],[18,61],[27,36]])}));return e}()}]),BidirectionalWebsocketRouter}(JSONRPC.RouterBase)}).call(t,r(3))},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var s=o.get;if(void 0!==s)return s.call(n)},f=r(0),l=r(49);l||(l={isMaster:!(self&&void 0===self.document),isWorker:!(!self||void 0!==self.document)});var JSONRPC={};JSONRPC.Exception=r(1),JSONRPC.Server=r(6),JSONRPC.IncomingRequest=r(10),JSONRPC.EndpointBase=r(5),JSONRPC.RouterBase=r(8),JSONRPC.Plugins={},JSONRPC.Plugins.Client=r(7),JSONRPC.Utils=r(2),e.exports=function(e){function BidirectionalWorkerRouter(e){o(this,BidirectionalWorkerRouter);var t=i(this,(BidirectionalWorkerRouter.__proto__||Object.getPrototypeOf(BidirectionalWorkerRouter)).call(this,e));return e.on("response",function(e){e.callResultSerialized=e.callResultToBeSerialized}),t._objWaitForWorkerReadyPromises={},t}return s(BidirectionalWorkerRouter,e),u(BidirectionalWorkerRouter,[{key:"addWorker",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,o){var i,s,u,c,p,h=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=6;break}if(!l.isWorker){e.next=3;break}throw new Error("The strEndpointPath param is mandatory inside workers.");case 3:o=null,e.next=7;break;case 6:o=JSONRPC.EndpointBase.normalizePath(o);case 7:if(f(l.isMaster||t===r||self===r,"Unknown worker type."),i=++this._nConnectionIDCounter,s=void 0,l.isMaster&&(this._objWaitForWorkerReadyPromises[i]={fnResolve:null,fnReject:null},s=new Promise(function(e,t){h._objWaitForWorkerReadyPromises[i].fnResolve=e,h._objWaitForWorkerReadyPromises[i].fnReject=t})),u={worker:r,nConnectionID:i,clientReverseCalls:null,clientWorkerTransportPlugin:null,strEndpointPath:o},this._objSessions[i]=u,c=function(){h.onConnectionEnded(i),r.terminate?r.terminate():r===t||r.isDead()||r.kill()},r.addEventListener?(r.addEventListener("message",function(){var e=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.isMaster||"object"!==a(t.data)||!t.data.jsonrpc||"rpc.connectToEndpoint"!==t.data.method){e.next=2;break}return e.abrupt("return",h._onRPCConnectToEndpoint(t.data,i));case 2:return e.next=4,h._routeMessage(t.data,u);case 4:case"end":return e.stop()}},e,h)}));return function(t){return e.apply(this,arguments)}}()),r.addEventListener("error",c)):(r.on("message",function(){var e=n(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.isMaster||"object"!==(void 0===t?"undefined":a(t))||!t.jsonrpc||"rpc.connectToEndpoint"!==t.method){e.next=2;break}return e.abrupt("return",h._onRPCConnectToEndpoint(t,i));case 2:return e.next=4,h._routeMessage(t,u);case 4:case"end":return e.stop()}},e,h)}));return function(t,r){return e.apply(this,arguments)}}()),r.on("exit",function(e,t){h.onConnectionEnded(i)}),r.on("error",c)),!l.isMaster){e.next=20;break}return p=setTimeout(function(e){h._objWaitForWorkerReadyPromises[i].fnReject(new Error("Timed out waiting for worker to be ready for JSONRPC."))},1e4),e.next=19,s;case 19:clearTimeout(p);case 20:return e.abrupt("return",i);case 21:case"end":return e.stop()}},e,this)}));return e}()},{key:"_onRPCConnectToEndpoint",value:function(e,t){var r=e.params[0];f("number"==typeof t,"nConnectionID must be of type number.");try{f("string"==typeof r,"strEndpointPath must be of type string."),this._objSessions[t].strEndpointPath=JSONRPC.EndpointBase.normalizePath(r),this._objWaitForWorkerReadyPromises[t].fnResolve(this._objSessions[t].strEndpointPath);var n=this._objSessions[t].worker,o={id:e.id,result:null,jsonrpc:"2.0"};n.postMessage?n.postMessage(o):n.send(o)}catch(r){var i=this._objSessions[t].worker,s={id:e.id,error:{message:r.message+"\n"+r.stack,code:0},jsonrpc:"2.0"};i.postMessage?i.postMessage(s):i.send(s),this._objWaitForWorkerReadyPromises[t].fnReject(r)}}},{key:"_makeReverseCallsClient",value:function(e,t){var r=new e(t.strEndpointPath);return t.clientWorkerTransportPlugin=new JSONRPC.Plugins.Client.WorkerTransport(t.worker,!0),r.addPlugin(t.clientWorkerTransportPlugin),this.emit("madeReverseCallsClient",r),r}},{key:"_routeMessage",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){var o,i,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.worker,i=n.nConnectionID,"object"===(void 0===r?"undefined":a(r))){e.next=5;break}return console.error("["+t.pid+"] WorkerBidirectionalRouter: Received "+(void 0===r?"undefined":a(r))+" instead of object. Ignoring. RAW message: "+JSON.stringify(r)),e.abrupt("return");case 5:if(e.prev=5,!r.hasOwnProperty("method")){e.next=29;break}if(this._jsonrpcServer){e.next=9;break}throw new Error("JSONRPC.Server not initialized on this Worker.");case 9:if(s=new JSONRPC.IncomingRequest,s.connectionID=i,s.router=this,e.prev=12,u=this._objSessions[i].strEndpointPath,this._jsonrpcServer.endpoints.hasOwnProperty(u)){e.next=16;break}throw new JSONRPC.Exception("Unknown JSONRPC endpoint "+u+".",JSONRPC.Exception.METHOD_NOT_FOUND);case 16:s.endpoint=this._jsonrpcServer.endpoints[u],s.requestBody=r,s.requestObject=r,e.next=24;break;case 21:e.prev=21,e.t0=e.catch(12),s.callResult=e.t0;case 24:return e.next=26,this._jsonrpcServer.processRequest(s);case 26:o.postMessage?o.postMessage(s.callResultSerialized):o.send(s.callResultSerialized),e.next=42;break;case 29:if(!r.hasOwnProperty("result")&&!r.hasOwnProperty("error")){e.next=41;break}if(!this._objSessions.hasOwnProperty(i)||null!==this._objSessions[i].clientWorkerTransportPlugin){e.next=33;break}throw o.terminate?o.terminate():o!==t&&o.kill(),new Error("How can the client be not initialized, and yet getting responses from phantom requests?");case 33:if(!this._objSessions.hasOwnProperty(i)){e.next=38;break}return e.next=36,this._objSessions[i].clientWorkerTransportPlugin.processResponse(r);case 36:e.next=39;break;case 38:console.error("Connection ID "+i+" is closed and session is missing. Ignoring response: "+JSON.stringify(r));case 39:e.next=42;break;case 41:throw new Error("Unable to qualify the message as a JSONRPC request or response.");case 42:e.next=51;break;case 44:e.prev=44,e.t1=e.catch(5),console.error(e.t1),console.error("Uncaught error. RAW remote message: "+JSON.stringify(r)),console.log("["+t.pid+"] Unclean state. Closing worker."),this.onConnectionEnded(i),o.terminate?o.terminate():o!==t&&o.kill();case 51:case"end":return e.stop()}},e,this,[[5,44],[12,21]])}));return e}()},{key:"onConnectionEnded",value:function(e){c(BidirectionalWorkerRouter.prototype.__proto__||Object.getPrototypeOf(BidirectionalWorkerRouter.prototype),"onConnectionEnded",this).call(this,e),delete this._objWaitForWorkerReadyPromises[e]}}]),BidirectionalWorkerRouter}(JSONRPC.RouterBase)}).call(t,r(3))},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),JSONRPC={};JSONRPC.Client=r(15),JSONRPC.Exception=r(1),e.exports=function(){function e(t,r,o){n(this,e),this._strMethod=t,this._arrParams=r,this._requestObject=null,this._mxRequestBody=null,this._mxResponseBody=null,this._responseObject=null,this._mxResult=null,this._strEndpointURL=null,this._objHeaders={},this._bCalled=!1,this._nCallID=o,Object.seal(this)}return i(e,[{key:"toRequestObject",value:function(){return s(null!==this.methodName,"this.methodName cannot be null."),s(Array.isArray(this.params),"this.params must be an Array."),{method:this.methodName,params:this.params,id:this.callID,jsonrpc:"2.0"}}},{key:"callID",get:function(){return s("number"==typeof this._nCallID,"this._nCallID must be of type number."),this._nCallID}},{key:"params",get:function(){return this._arrParams},set:function(e){s(Array.isArray(e),"arrParams must be of type Array."),this._arrParams=e}},{key:"methodName",get:function(){return this._strMethod},set:function(e){s("string"==typeof e,"strMethod must be of type string."),this._strMethod=e}},{key:"headers",get:function(){return this._objHeaders}},{key:"endpointURL",get:function(){return this._strEndpointURL},set:function(e){s("string"==typeof e,"strEndpointURL must be of type string."),this._strEndpointURL=e}},{key:"requestObject",get:function(){return this._requestObject},set:function(e){s("object"===(void 0===e?"undefined":o(e))||Array.isArray(e),"objRequest must be of type Object or Array."),s(e.hasOwnProperty("method")||e.hasOwnProperty("params"),JSON.stringify(e),"objRequest must have either a method or params property."),this._requestObject=e}},{key:"requestBody",get:function(){return this._mxRequestBody},set:function(e){this._mxRequestBody=e}},{key:"isMethodCalled",get:function(){return this._bCalled},set:function(e){this._bCalled=e}},{key:"responseBody",get:function(){return this._mxResponseBody},set:function(e){s("string"==typeof e||"object"===(void 0===e?"undefined":o(e)),"mxResponseBody must be of type string or Object."),this._mxResponseBody=e}},{key:"responseObject",get:function(){return this._responseObject},set:function(e){if("object"!==(void 0===e?"undefined":o(e))&&!e.hasOwnProperty("result")&&!e.hasOwnProperty("error"))throw new JSONRPC.Exception("Invalid response structure. RAW response: "+JSON.stringify(this._mxResponseBody,void 0,"\t"),JSONRPC.Exception.PARSE_ERROR);this._responseObject=e}},{key:"callResult",get:function(){return this.isMethodCalled=!0,this._mxResult},set:function(e){this.isMethodCalled=!0,this._mxResult=e}}]),e}()},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),e.exports=function(e){function DebugLogger(){return o(this,DebugLogger),i(this,(DebugLogger.__proto__||Object.getPrototypeOf(DebugLogger)).apply(this,arguments))}return s(DebugLogger,e),a(DebugLogger,[{key:"afterJSONEncode",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n="string"==typeof r.requestBody?r.requestBody:JSON.stringify(r.requestBody),n.length>1048576?console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Sent JSONRPC request, "+r.requestObject.method+"(). Larger than 1 MB, not logging. \n"):console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Sent JSONRPC request: "+n+"\n");case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"beforeJSONDecode",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n="string"==typeof r.responseBody?r.responseBody:JSON.stringify(r.responseBody),n.length>1048576?console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Received JSONRPC response, "+r.requestObject.method+"(). Larger than 1 MB, not logging. \n"):console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Received JSONRPC response: "+n+"\n");case 2:case"end":return e.stop()}},e,this)}));return e}()}]),DebugLogger}(JSONRPC.ClientPluginBase)}).call(t,r(3))},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),JSONRPC.Exception=r(1),e.exports=function(e){function PrettyBrowserConsoleErrors(){return o(this,PrettyBrowserConsoleErrors),i(this,(PrettyBrowserConsoleErrors.__proto__||Object.getPrototypeOf(PrettyBrowserConsoleErrors)).apply(this,arguments))}return s(PrettyBrowserConsoleErrors,e),a(PrettyBrowserConsoleErrors,[{key:"exceptionCatch",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.error(t.callResult);case 1:case"end":return e.stop()}},e,this)}));return e}()}]),PrettyBrowserConsoleErrors}(JSONRPC.ClientPluginBase)},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),JSONRPC.Utils=r(2);var u=r(51);e.exports=function(e){function ProcessStdIOTransport(e,t){o(this,ProcessStdIOTransport);var r=i(this,(ProcessStdIOTransport.__proto__||Object.getPrototypeOf(ProcessStdIOTransport)).call(this));return r._strEndpointCommand=e,r._strWorkingDirectoryPath=t,r}return s(ProcessStdIOTransport,e),a(ProcessStdIOTransport,[{key:"makeRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r,n,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isMethodCalled){e.next=2;break}return e.abrupt("return");case 2:return t.isMethodCalled=!0,r={cwd:this._strWorkingDirectoryPath,maxBuffer:10485760},n=this._strEndpointCommand.trim().split(/[\s]+/,1)[0],o=this._strEndpointCommand.substr(n.length).trim(),i=u.spawn(n,[o],r),e.abrupt("return",new Promise(function(e,r){i.on("close",function(t){i.stdin.end(),e(null)}),t.responseBody="",i.stdout.on("data",function(e){t.responseBody+=e}),i.on("error",function(e){r(e)}),i.stdin.setEncoding("utf-8"),i.stdin.write(t.requestBody)}));case 8:case"end":return e.stop()}},e,this)}));return e}()}]),ProcessStdIOTransport}(JSONRPC.ClientPluginBase)},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4);var u=r(38);e.exports=function(e){function SignatureAdd(e,t){o(this,SignatureAdd);var r=i(this,(SignatureAdd.__proto__||Object.getPrototypeOf(SignatureAdd)).call(this));return r.strAPIKey=e,r._arrExtraURLVariables=t,r.strKeyMetaData=SignatureAdd.getKeyMetaData(e),r}return s(SignatureAdd,e),a(SignatureAdd,[{key:"beforeJSONEncode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.requestObject.expires=parseInt((new Date).getTime()/1e3+86400,10);case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterJSONEncode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=new u("SHA-256","TEXT"),r.setHMACKey(this.strAPIKey,"TEXT"),r.update(t.requestBody),n=r.getHMAC("HEX"),null!==this.strKeyMetaData&&(n=this.strKeyMetaData+":"+n),t.endpointURL.indexOf("?")>-1?t.endpointURL+="&":t.endpointURL+="?",-1===t.endpointURL.indexOf("verify")&&(t.endpointURL+="verify="+n),"&"===t.endpointURL.charAt(t.endpointURL.length-1)&&(t.endpointURL=t.endpointURL.slice(0,-1));for(o in this._arrExtraURLVariables)t.endpointURL+="&"+o+"="+this._arrExtraURLVariables[o];case 9:case"end":return e.stop()}},e,this)}));return e}()}],[{key:"getKeyMetaData",value:function(e){var t=null,r=e.split(":",2);return 1!==r.length&&(t=r[0]),t}}]),SignatureAdd}(JSONRPC.ClientPluginBase)},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),JSONRPC.Utils=r(2);var u=r(0);e.exports=function(e){function WebRTCTransport(e,t){o(this,WebRTCTransport);var r=i(this,(WebRTCTransport.__proto__||Object.getPrototypeOf(WebRTCTransport)).call(this));return r._objRTCDataChannelRequestsPromises={},r._bBidirectionalWebRTCMode=!!t,r._dataChannel=e,r._setupRTCDataChannel(),r}return s(WebRTCTransport,e),a(WebRTCTransport,[{key:"processResponse",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=11;break}e.prev=1,n=JSONRPC.Utils.jsonDecodeSafe(r),e.next=11;break;case 5:return e.prev=5,e.t0=e.catch(1),console.error(e.t0),console.error("Unable to parse JSON. RAW remote response: "+r),"open"===this._dataChannel.readyState&&this._dataChannel.close(),e.abrupt("return");case 11:if("number"==typeof n.id&&this._objRTCDataChannelRequestsPromises[n.id]){e.next=17;break}return console.error(new Error("Couldn't find JSONRPC response call ID in this._objRTCDataChannelRequestsPromises. RAW response: "+r)),console.error(new Error("RAW remote message: "+r)),console.log("["+t.pid+"] Unclean state. Unable to match WebRTC message to an existing Promise or qualify it as a request."),"open"===this._dataChannel.readyState&&this.dataChannel.close(1e3,"Unclean state. Unable to match WebRTC message to an existing Promise or qualify it as a request."),e.abrupt("return");case 17:this._objRTCDataChannelRequestsPromises[n.id].outgoingRequest.responseBody=r,this._objRTCDataChannelRequestsPromises[n.id].outgoingRequest.responseObject=n,this._objRTCDataChannelRequestsPromises[n.id].fnResolve(null),delete this._objRTCDataChannelRequestsPromises[n.id];case 21:case"end":return e.stop()}},e,this,[[1,5]])}));return e}()},{key:"makeRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isMethodCalled){e.next=2;break}return e.abrupt("return");case 2:if("open"===this.dataChannel.readyState){e.next=4;break}throw new Error("RTCDataChannel not connected.");case 4:return t.isMethodCalled=!0,u("number"==typeof t.requestObject.id,"outgoingRequest.requestObject.id must be of type number."),this._objRTCDataChannelRequestsPromises[t.requestObject.id]={outgoingRequest:t,promise:null},this._objRTCDataChannelRequestsPromises[t.requestObject.id].promise=new Promise(function(e,n){r._objRTCDataChannelRequestsPromises[t.requestObject.id].fnResolve=e,r._objRTCDataChannelRequestsPromises[t.requestObject.id].fnReject=n}),this.dataChannel.send(t.requestBody),e.abrupt("return",this._objRTCDataChannelRequestsPromises[t.requestObject.id].promise);case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"rejectAllPromises",value:function(e){console.log("["+t.pid+"] Rejecting all Promise instances in WebRTCTransport.");var r=0;for(var n in this._objRTCDataChannelRequestsPromises)this._objRTCDataChannelRequestsPromises[n].fnReject(e),delete this._objRTCDataChannelRequestsPromises[n],r++;r&&console.error("["+t.pid+"] Rejected "+r+" Promise instances in WebRTCTransport.")}},{key:"_setupRTCDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("close",function(t){e.rejectAllPromises(new Error("RTCDataChannel closed."))}),this._dataChannel.addEventListener("error",function(t){e.rejectAllPromises(t)}),this._bBidirectionalWebRTCMode||this._dataChannel.addEventListener("message",function(){var t=n(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processResponse(r.data);case 2:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())}},{key:"dataChannel",get:function(){return this._dataChannel}}]),WebRTCTransport}(JSONRPC.ClientPluginBase)}).call(t,r(3))},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),JSONRPC.Utils=r(2),JSONRPC.WebSocketAdapters={},JSONRPC.WebSocketAdapters.WebSocketWrapperBase=r(12);var u=r(0);e.exports=function(e){function WebSocketTransport(e,t){o(this,WebSocketTransport);var r=i(this,(WebSocketTransport.__proto__||Object.getPrototypeOf(WebSocketTransport)).call(this));return r._objWebSocketRequestsPromises={},r._bBidirectionalWebSocketMode=!!t,r._webSocket=e,r._setupWebSocket(),r}return s(WebSocketTransport,e),a(WebSocketTransport,[{key:"processResponse",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=11;break}e.prev=1,n=JSONRPC.Utils.jsonDecodeSafe(r),e.next=11;break;case 5:return e.prev=5,e.t0=e.catch(1),console.error(e.t0),console.error("Unable to parse JSON. RAW remote response: "+r),this._webSocket.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&this._webSocket.close(1e3,"Unable to parse JSON. RAW remote response: "+r),e.abrupt("return");case 11:if("number"==typeof n.id&&this._objWebSocketRequestsPromises[n.id]){e.next=17;break}return console.error(new Error("Couldn't find JSONRPC response call ID in this._objWebSocketRequestsPromises. RAW response: "+r)),console.error(new Error("RAW remote message: "+r)),console.log("["+t.pid+"] Unclean state. Unable to match WebSocket message to an existing Promise or qualify it as a request."),this._webSocket.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&this.webSocket.close(1e3,"Unclean state. Unable to match WebSocket message to an existing Promise or qualify it as a request."),e.abrupt("return");case 17:this._objWebSocketRequestsPromises[n.id].outgoingRequest.responseBody=r,this._objWebSocketRequestsPromises[n.id].outgoingRequest.responseObject=n,this._objWebSocketRequestsPromises[n.id].fnResolve(null),delete this._objWebSocketRequestsPromises[n.id];case 21:case"end":return e.stop()}},e,this,[[1,5]])}));return e}()},{key:"makeRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isMethodCalled){e.next=2;break}return e.abrupt("return");case 2:if(this.webSocket.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN){e.next=4;break}throw new Error("WebSocket not connected.");case 4:return t.isMethodCalled=!0,u("number"==typeof t.requestObject.id,"outgoingRequest.requestObject.id must be of type number."),this._objWebSocketRequestsPromises[t.requestObject.id]={outgoingRequest:t,promise:null},this._objWebSocketRequestsPromises[t.requestObject.id].promise=new Promise(function(e,n){r._objWebSocketRequestsPromises[t.requestObject.id].fnResolve=e,r._objWebSocketRequestsPromises[t.requestObject.id].fnReject=n}),this.webSocket.send(t.requestBody),e.abrupt("return",this._objWebSocketRequestsPromises[t.requestObject.id].promise);case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"rejectAllPromises",value:function(e){console.log("["+t.pid+"] Rejecting all Promise instances in WebSocketTransport.");var r=0;for(var n in this._objWebSocketRequestsPromises)this._objWebSocketRequestsPromises[n].fnReject(e),delete this._objWebSocketRequestsPromises[n],r++;r&&console.error("["+t.pid+"] Rejected "+r+" Promise instances in WebSocketTransport.")}},{key:"_setupWebSocket",value:function(){var e=this;this._webSocket.addEventListener?(this._webSocket.addEventListener("close",function(t){e.rejectAllPromises(new Error("WebSocket closed. Code: "+JSON.stringify(t.code)+". Message: "+JSON.stringify(t.reason)+". wasClean: "+JSON.stringify(t.wasClean)))}),this._webSocket.addEventListener("error",function(t){e.rejectAllPromises(t)}),this._bBidirectionalWebSocketMode||this._webSocket.addEventListener("message",function(){var t=n(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processResponse(r.data);case 2:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())):(this._webSocket.on("close",function(t,r,n){e.rejectAllPromises(new Error("WebSocket closed. Code: "+JSON.stringify(t)+". Message: "+JSON.stringify(r)))}),this._webSocket.on("error",function(t){e.rejectAllPromises(t)}),this._bBidirectionalWebSocketMode||this._webSocket.on("message",function(){var t=n(regeneratorRuntime.mark(function t(r,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processResponse(r);case 2:case"end":return t.stop()}},t,e)}));return function(e,r){return t.apply(this,arguments)}}()))}},{key:"webSocket",get:function(){return this._webSocket}}]),WebSocketTransport}(JSONRPC.ClientPluginBase)}).call(t,r(3))},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),JSONRPC.Utils=r(2);var u=r(0);e.exports=function(e){function WorkerTransport(e,t){o(this,WorkerTransport);var r=i(this,(WorkerTransport.__proto__||Object.getPrototypeOf(WorkerTransport)).call(this));return r._objWorkerRequestsPromises={},r._bBidirectionalWorkerMode=!!t,r._worker=e,r._setupWorker(),r}return s(WorkerTransport,e),a(WorkerTransport,[{key:"beforeJSONEncode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.requestBody=t.requestObject;case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"processResponse",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("number"==typeof r.id&&this._objWorkerRequestsPromises[r.id]){e.next=6;break}return console.error(new Error("Couldn't find JSONRPC response call ID in this._objWorkerRequestsPromises. RAW response: "+JSON.stringify(r))),console.error(new Error("RAW remote message: "+JSON.stringify(r))),console.log("["+t.pid+"] Unclean state. Unable to match Worker message to an existing Promise or qualify it as a request."),this.worker.terminate?this.worker.terminate():this.worker!==t&&this.worker.kill(),e.abrupt("return");case 6:this._objWorkerRequestsPromises[r.id].outgoingRequest.responseBody=r,this._objWorkerRequestsPromises[r.id].outgoingRequest.responseObject=r,this._objWorkerRequestsPromises[r.id].fnResolve(null),delete this._objWorkerRequestsPromises[r.id];case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"makeRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isMethodCalled){e.next=2;break}return e.abrupt("return");case 2:if(!this.worker.isDead||!this.worker.isDead()){e.next=4;break}throw new Error("Worker not connected.");case 4:return t.isMethodCalled=!0,u("number"==typeof t.requestObject.id,"outgoingRequest.requestObject.id must be of type number."),this._objWorkerRequestsPromises[t.requestObject.id]={outgoingRequest:t,promise:null},this._objWorkerRequestsPromises[t.requestObject.id].promise=new Promise(function(e,n){r._objWorkerRequestsPromises[t.requestObject.id].fnResolve=e,r._objWorkerRequestsPromises[t.requestObject.id].fnReject=n}),this.worker.postMessage?this.worker.postMessage(t.requestObject):this.worker.send(t.requestObject),e.abrupt("return",this._objWorkerRequestsPromises[t.requestObject.id].promise);case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"beforeJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.responseObject=t.responseBody;case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"rejectAllPromises",value:function(e){console.log("["+t.pid+"] Rejecting all Promise instances in WorkerTransport.");var r=0;for(var n in this._objWorkerRequestsPromises)this._objWorkerRequestsPromises[n].fnReject(e),delete this._objWorkerRequestsPromises[n],r++;r&&console.error("["+t.pid+"] Rejected "+r+" Promise instances in WorkerTransport.")}},{key:"_setupWorker",value:function(){var e=this;this._worker.addEventListener?(this._worker.addEventListener("error",function(t){e.rejectAllPromises(t)}),this._bBidirectionalWorkerMode||this._worker.addEventListener("message",function(){var t=n(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processResponse(r.data);case 2:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())):(this._worker.on("exit",function(t,r){e.rejectAllPromises(new Error("Worker closed. Code: "+JSON.stringify(t)+". Signal: "+JSON.stringify(r)))}),this._worker.on("error",function(t){e.rejectAllPromises(t)}),this._bBidirectionalWorkerMode||this._worker.on("message",function(){var t=n(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processResponse(r);case 2:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}()))}},{key:"worker",get:function(){return this._worker}}]),WorkerTransport}(JSONRPC.ClientPluginBase)}).call(t,r(3))},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ServerPluginBase=r(11),e.exports=function(e){function AuthenticationSkip(){return o(this,AuthenticationSkip),i(this,(AuthenticationSkip.__proto__||Object.getPrototypeOf(AuthenticationSkip)).apply(this,arguments))}return s(AuthenticationSkip,e),a(AuthenticationSkip,[{key:"beforeJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.isAuthenticated=!0;case 1:case"end":return e.stop()}},e,this)}));return e}()}]),AuthenticationSkip}(JSONRPC.ServerPluginBase)},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ServerPluginBase=r(11),e.exports=function(e){function AuthenticationSkip(){return o(this,AuthenticationSkip),i(this,(AuthenticationSkip.__proto__||Object.getPrototypeOf(AuthenticationSkip)).apply(this,arguments))}return s(AuthenticationSkip,e),a(AuthenticationSkip,[{key:"beforeJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.isAuthorized=!0;case 1:case"end":return e.stop()}},e,this)}));return e}()}]),AuthenticationSkip}(JSONRPC.ServerPluginBase)},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,i){try{var s=t[o](i),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ServerPluginBase=r(11),e.exports=function(e){function DebugLogger(){return o(this,DebugLogger),i(this,(DebugLogger.__proto__||Object.getPrototypeOf(DebugLogger)).apply(this,arguments))}return s(DebugLogger,e),a(DebugLogger,[{key:"beforeJSONDecode",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.requestBody.length>1048576?console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Received JSONRPC request at endpoint path "+r.endpoint.path+", "+r.requestObject.method+"(). Larger than 1 MB, not logging. \n"):console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Received JSONRPC request at endpoint path "+r.endpoint.path+": "+r.requestBody+"\n");case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterSerialize",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.requestBody.length>1048576?console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Sending JSONRPC response, "+r.requestObject.method+"(). Larger than 1 MB, not logging. \n"):console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Sending JSONRPC response: "+r.callResultSerialized+"\n");case 1:case"end":return e.stop()}},e,this)}));return e}()}]),DebugLogger}(JSONRPC.ServerPluginBase)}).call(t,r(3))},function(e,t,r){"use strict";var n={};n.DebugLogger=r(31),n.AuthenticationSkip=r(29),n.AuthorizeAll=r(30),e.exports=n},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var s=o.get;if(void 0!==s)return s.call(n)},WebSocketWrapperBase=r(12);e.exports=function(e){function WebSocketWrapper(e,t){n(this,WebSocketWrapper);var r=o(this,(WebSocketWrapper.__proto__||Object.getPrototypeOf(WebSocketWrapper)).call(this,e));return r._strURL="string"==typeof t?t:e.url?e.url:e.upgradeReq.url,r.objListeningFor={},e.upgradeReq?r._objUpgradeReq=e.upgradeReq:r._objUpgradeReq=void 0,r}return i(WebSocketWrapper,e),s(WebSocketWrapper,[{key:"on",value:function(e,t){var r=this;if(a(WebSocketWrapper.prototype.__proto__||Object.getPrototypeOf(WebSocketWrapper.prototype),"superOn",this).call(this,e,t),!this.objListeningFor[e])return this.objListeningFor[e]=!0,this._webSocket.on(e,function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];r.emit.apply(r,[e].concat(n))})}},{key:"url",get:function(){return this._strURL}},{key:"upgradeReq",get:function(){return this._objUpgradeReq}}]),WebSocketWrapper}(WebSocketWrapperBase)},function(e,t,r){"use strict";function n(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function o(e){return 3*e.length/4-n(e)}function i(e){var t,r,o,i,s,a,u=e.length;s=n(e),a=new l(3*u/4-s),o=s>0?u-4:u;var c=0;for(t=0,r=0;t<o;t+=4,r+=3)i=f[e.charCodeAt(t)]<<18|f[e.charCodeAt(t+1)]<<12|f[e.charCodeAt(t+2)]<<6|f[e.charCodeAt(t+3)],a[c++]=i>>16&255,a[c++]=i>>8&255,a[c++]=255&i;return 2===s?(i=f[e.charCodeAt(t)]<<2|f[e.charCodeAt(t+1)]>>4,a[c++]=255&i):1===s&&(i=f[e.charCodeAt(t)]<<10|f[e.charCodeAt(t+1)]<<4|f[e.charCodeAt(t+2)]>>2,a[c++]=i>>8&255,a[c++]=255&i),a}function s(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function a(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16)+(e[i+1]<<8)+e[i+2],o.push(s(n));return o.join("")}function u(e){for(var t,r=e.length,n=r%3,o="",i=[],s=0,u=r-n;s<u;s+=16383)i.push(a(e,s,s+16383>u?u:s+16383));return 1===n?(t=e[r-1],o+=c[t>>2],o+=c[t<<4&63],o+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],o+=c[t>>10],o+=c[t>>4&63],o+=c[t<<2&63],o+="="),i.push(o),i.join("")}t.byteLength=o,t.toByteArray=i,t.fromByteArray=u;for(var c=[],f=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,b=p.length;h<b;++h)c[h]=p[h],f[p.charCodeAt(h)]=h;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(e){function t(e){n(this,t);var r=o(this,Object.getPrototypeOf(t).call(this,e));return r.name=r.constructor.name,r.message=e,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(r,r.constructor):r.stack=new Error(e).stack,r}return i(t,e),t}(function(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Error));e.exports=s},function(e,t){t.read=function(e,t,r,n,o){var i,s,a=8*o-n-1,u=(1<<a)-1,c=u>>1,f=-7,l=r?o-1:0,p=r?-1:1,h=e[t+l];for(l+=p,i=h&(1<<-f)-1,h>>=-f,f+=a;f>0;i=256*i+e[t+l],l+=p,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=n;f>0;s=256*s+e[t+l],l+=p,f-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,n),i-=c}return(h?-1:1)*s*Math.pow(2,i-n)},t.write=function(e,t,r,n,o,i){var s,a,u,c=8*i-o-1,f=(1<<c)-1,l=f>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,b=n?1:-1,d=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),t+=s+l>=1?p/u:p*Math.pow(2,1-l),t*u>=2&&(s++,u/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(t*u-1)*Math.pow(2,o),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,o),s=0));o>=8;e[r+h]=255&a,h+=b,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;e[r+h]=255&s,h+=b,s/=256,c-=8);e[r+h-b]|=128*d}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";var n;!function(o){function i(e,t,r){var n,o,i,s,h,b,d,y,v,g=0,m=[],w=0,R=!1,_=[],k=[],S=!1,O=!1,P=-1;if(r=r||{},n=r.encoding||"UTF8",(v=r.numRounds||1)!==parseInt(v,10)||1>v)throw Error("numRounds must a integer >= 1");if("SHA-1"===e)h=512,b=D,d=I,s=160,y=function(e){return e.slice()};else if(0===e.lastIndexOf("SHA-",0))if(b=function(t,r){return L(t,r,e)},d=function(t,r,n,o){var i,s;if("SHA-224"===e||"SHA-256"===e)i=15+(r+65>>>9<<4),s=16;else{if("SHA-384"!==e&&"SHA-512"!==e)throw Error("Unexpected error in SHA-2 implementation");i=31+(r+129>>>10<<5),s=32}for(;t.length<=i;)t.push(0);for(t[r>>>5]|=128<<24-r%32,r+=n,t[i]=4294967295&r,t[i-1]=r/4294967296|0,n=t.length,r=0;r<n;r+=s)o=L(t.slice(r,r+s),o,e);if("SHA-224"===e)t=[o[0],o[1],o[2],o[3],o[4],o[5],o[6]];else if("SHA-256"===e)t=o;else if("SHA-384"===e)t=[o[0].a,o[0].b,o[1].a,o[1].b,o[2].a,o[2].b,o[3].a,o[3].b,o[4].a,o[4].b,o[5].a,o[5].b];else{if("SHA-512"!==e)throw Error("Unexpected error in SHA-2 implementation");t=[o[0].a,o[0].b,o[1].a,o[1].b,o[2].a,o[2].b,o[3].a,o[3].b,o[4].a,o[4].b,o[5].a,o[5].b,o[6].a,o[6].b,o[7].a,o[7].b]}return t},y=function(e){return e.slice()},"SHA-224"===e)h=512,s=224;else if("SHA-256"===e)h=512,s=256;else if("SHA-384"===e)h=1024,s=384;else{if("SHA-512"!==e)throw Error("Chosen SHA variant is not supported");h=1024,s=512}else{if(0!==e.lastIndexOf("SHA3-",0)&&0!==e.lastIndexOf("SHAKE",0))throw Error("Chosen SHA variant is not supported");var E=6;if(b=M,y=function(e){var t,r=[];for(t=0;5>t;t+=1)r[t]=e[t].slice();return r},P=1,"SHA3-224"===e)h=1152,s=224;else if("SHA3-256"===e)h=1088,s=256;else if("SHA3-384"===e)h=832,s=384;else if("SHA3-512"===e)h=576,s=512;else if("SHAKE128"===e)h=1344,s=-1,E=31,O=!0;else{if("SHAKE256"!==e)throw Error("Chosen SHA variant is not supported");h=1088,s=-1,E=31,O=!0}d=function(e,t,r,n,o){r=h;var i,s=E,a=[],u=r>>>5,c=0,f=t>>>5;for(i=0;i<f&&t>=r;i+=u)n=M(e.slice(i,i+u),n),t-=r;for(e=e.slice(i),t%=r;e.length<u;)e.push(0);for(i=t>>>3,e[i>>2]^=s<<i%4*8,e[u-1]^=2147483648,n=M(e,n);32*a.length<o&&(e=n[c%5][c/5|0],a.push(e.b),!(32*a.length>=o));)a.push(e.a),0==64*(c+=1)%r&&M(null,n);return a}}i=p(t,n,P),o=W(e),this.setHMACKey=function(t,r,i){var a;if(!0===R)throw Error("HMAC key already set");if(!0===S)throw Error("Cannot set HMAC key after calling update");if(!0===O)throw Error("SHAKE is not supported for HMAC");if(n=(i||{}).encoding||"UTF8",r=p(r,n,P)(t),t=r.binLen,r=r.value,a=h>>>3,i=a/4-1,a<t/8){for(r=d(r,t,0,W(e),s);r.length<=i;)r.push(0);r[i]&=4294967040}else if(a>t/8){for(;r.length<=i;)r.push(0);r[i]&=4294967040}for(t=0;t<=i;t+=1)_[t]=909522486^r[t],k[t]=1549556828^r[t];o=b(_,o),g=h,R=!0},this.update=function(e){var t,r,n,s=0,a=h>>>5;for(t=i(e,m,w),e=t.binLen,r=t.value,t=e>>>5,n=0;n<t;n+=a)s+h<=e&&(o=b(r.slice(n,n+a),o),s+=h);g+=s,m=r.slice(s>>>5),w=e%h,S=!0},this.getHash=function(t,r){var n,i,p,h;if(!0===R)throw Error("Cannot call getHash after setting HMAC key");if(p=l(r),!0===O){if(-1===p.shakeLen)throw Error("shakeLen must be specified in options");s=p.shakeLen}switch(t){case"HEX":n=function(e){return a(e,s,P,p)};break;case"B64":n=function(e){return u(e,s,P,p)};break;case"BYTES":n=function(e){return c(e,s,P)};break;case"ARRAYBUFFER":try{i=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}n=function(e){return f(e,s,P)};break;default:throw Error("format must be HEX, B64, BYTES, or ARRAYBUFFER")}for(h=d(m.slice(),w,g,y(o),s),i=1;i<v;i+=1)!0===O&&0!=s%32&&(h[h.length-1]&=16777215>>>24-s%32),h=d(h,s,0,W(e),s);return n(h)},this.getHMAC=function(t,r){var n,i,p,v;if(!1===R)throw Error("Cannot call getHMAC without first setting HMAC key");switch(p=l(r),t){case"HEX":n=function(e){return a(e,s,P,p)};break;case"B64":n=function(e){return u(e,s,P,p)};break;case"BYTES":n=function(e){return c(e,s,P)};break;case"ARRAYBUFFER":try{n=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}n=function(e){return f(e,s,P)};break;default:throw Error("outputFormat must be HEX, B64, BYTES, or ARRAYBUFFER")}return i=d(m.slice(),w,g,y(o),s),v=b(k,W(e)),v=d(i,s,h,v,s),n(v)}}function s(e,t){this.a=e,this.b=t}function a(e,t,r,n){var o="";t/=8;var i,s,a;for(a=-1===r?3:0,i=0;i<t;i+=1)s=e[i>>>2]>>>8*(a+i%4*r),o+="0123456789abcdef".charAt(s>>>4&15)+"0123456789abcdef".charAt(15&s);return n.outputUpper?o.toUpperCase():o}function u(e,t,r,n){var o,i,s,a,u="",c=t/8;for(a=-1===r?3:0,o=0;o<c;o+=3)for(i=o+1<c?e[o+1>>>2]:0,s=o+2<c?e[o+2>>>2]:0,s=(e[o>>>2]>>>8*(a+o%4*r)&255)<<16|(i>>>8*(a+(o+1)%4*r)&255)<<8|s>>>8*(a+(o+2)%4*r)&255,i=0;4>i;i+=1)u+=8*o+6*i<=t?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>>6*(3-i)&63):n.b64Pad;return u}function c(e,t,r){var n="";t/=8;var o,i,s;for(s=-1===r?3:0,o=0;o<t;o+=1)i=e[o>>>2]>>>8*(s+o%4*r)&255,n+=String.fromCharCode(i);return n}function f(e,t,r){t/=8;var n,o,i,s=new ArrayBuffer(t);for(i=new Uint8Array(s),o=-1===r?3:0,n=0;n<t;n+=1)i[n]=e[n>>>2]>>>8*(o+n%4*r)&255;return s}function l(e){var t={outputUpper:!1,b64Pad:"=",shakeLen:-1};if(e=e||{},t.outputUpper=e.outputUpper||!1,!0===e.hasOwnProperty("b64Pad")&&(t.b64Pad=e.b64Pad),!0===e.hasOwnProperty("shakeLen")){if(0!=e.shakeLen%8)throw Error("shakeLen must be a multiple of 8");t.shakeLen=e.shakeLen}if("boolean"!=typeof t.outputUpper)throw Error("Invalid outputUpper formatting option");if("string"!=typeof t.b64Pad)throw Error("Invalid b64Pad formatting option");return t}function p(e,t,r){switch(t){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":e=function(e,t,n){var o,i,s,a,u,c,f=e.length;if(0!=f%2)throw Error("String of HEX type must be in byte increments");for(t=t||[0],n=n||0,u=n>>>3,c=-1===r?3:0,o=0;o<f;o+=2){if(i=parseInt(e.substr(o,2),16),isNaN(i))throw Error("String of HEX type contains invalid characters");for(a=(o>>>1)+u,s=a>>>2;t.length<=s;)t.push(0);t[s]|=i<<8*(c+a%4*r)}return{value:t,binLen:4*f+n}};break;case"TEXT":e=function(e,n,o){var i,s,a,u,c,f,l,p,h=0;if(n=n||[0],o=o||0,c=o>>>3,"UTF8"===t)for(p=-1===r?3:0,a=0;a<e.length;a+=1)for(i=e.charCodeAt(a),s=[],128>i?s.push(i):2048>i?(s.push(192|i>>>6),s.push(128|63&i)):55296>i||57344<=i?s.push(224|i>>>12,128|i>>>6&63,128|63&i):(a+=1,i=65536+((1023&i)<<10|1023&e.charCodeAt(a)),s.push(240|i>>>18,128|i>>>12&63,128|i>>>6&63,128|63&i)),u=0;u<s.length;u+=1){for(l=h+c,f=l>>>2;n.length<=f;)n.push(0);n[f]|=s[u]<<8*(p+l%4*r),h+=1}else if("UTF16BE"===t||"UTF16LE"===t)for(p=-1===r?2:0,a=0;a<e.length;a+=1){for(i=e.charCodeAt(a),"UTF16LE"===t&&(u=255&i,i=u<<8|i>>>8),l=h+c,f=l>>>2;n.length<=f;)n.push(0);n[f]|=i<<8*(p+l%4*r),h+=2}return{value:n,binLen:8*h+o}};break;case"B64":e=function(e,t,n){var o,i,s,a,u,c,f,l,p=0;if(-1===e.search(/^[a-zA-Z0-9=+\/]+$/))throw Error("Invalid character in base-64 string");if(i=e.indexOf("="),e=e.replace(/\=/g,""),-1!==i&&i<e.length)throw Error("Invalid '=' found in base-64 string");for(t=t||[0],n=n||0,c=n>>>3,l=-1===r?3:0,i=0;i<e.length;i+=4){for(u=e.substr(i,4),s=a=0;s<u.length;s+=1)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(u[s]),a|=o<<18-6*s;for(s=0;s<u.length-1;s+=1){for(f=p+c,o=f>>>2;t.length<=o;)t.push(0);t[o]|=(a>>>16-8*s&255)<<8*(l+f%4*r),p+=1}}return{value:t,binLen:8*p+n}};break;case"BYTES":e=function(e,t,n){var o,i,s,a,u,c;for(t=t||[0],n=n||0,s=n>>>3,c=-1===r?3:0,i=0;i<e.length;i+=1)o=e.charCodeAt(i),u=i+s,a=u>>>2,t.length<=a&&t.push(0),t[a]|=o<<8*(c+u%4*r);return{value:t,binLen:8*e.length+n}};break;case"ARRAYBUFFER":try{e=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}e=function(e,t,n){var o,i,s,a,u,c;for(t=t||[0],n=n||0,i=n>>>3,u=-1===r?3:0,c=new Uint8Array(e),o=0;o<e.byteLength;o+=1)a=o+i,s=a>>>2,t.length<=s&&t.push(0),t[s]|=c[o]<<8*(u+a%4*r);return{value:t,binLen:8*e.byteLength+n}};break;default:throw Error("format must be HEX, TEXT, B64, BYTES, or ARRAYBUFFER")}return e}function h(e,t){return e<<t|e>>>32-t}function b(e,t){return 32<t?(t-=32,new s(e.b<<t|e.a>>>32-t,e.a<<t|e.b>>>32-t)):0!==t?new s(e.a<<t|e.b>>>32-t,e.b<<t|e.a>>>32-t):e}function d(e,t){return e>>>t|e<<32-t}function y(e,t){var r=null,r=new s(e.a,e.b);return r=32>=t?new s(r.a>>>t|r.b<<32-t&4294967295,r.b>>>t|r.a<<32-t&4294967295):new s(r.b>>>t-32|r.a<<64-t&4294967295,r.a>>>t-32|r.b<<64-t&4294967295)}function v(e,t){return 32>=t?new s(e.a>>>t,e.b>>>t|e.a<<32-t&4294967295):new s(0,e.a>>>t-32)}function g(e,t,r){return e&t^~e&r}function m(e,t,r){return new s(e.a&t.a^~e.a&r.a,e.b&t.b^~e.b&r.b)}function w(e,t,r){return e&t^e&r^t&r}function R(e,t,r){return new s(e.a&t.a^e.a&r.a^t.a&r.a,e.b&t.b^e.b&r.b^t.b&r.b)}function _(e){return d(e,2)^d(e,13)^d(e,22)}function k(e){var t=y(e,28),r=y(e,34);return e=y(e,39),new s(t.a^r.a^e.a,t.b^r.b^e.b)}function S(e){return d(e,6)^d(e,11)^d(e,25)}function O(e){var t=y(e,14),r=y(e,18);return e=y(e,41),new s(t.a^r.a^e.a,t.b^r.b^e.b)}function P(e){return d(e,7)^d(e,18)^e>>>3}function E(e){var t=y(e,1),r=y(e,8);return e=v(e,7),new s(t.a^r.a^e.a,t.b^r.b^e.b)}function x(e){return d(e,17)^d(e,19)^e>>>10}function j(e){var t=y(e,19),r=y(e,61);return e=v(e,6),new s(t.a^r.a^e.a,t.b^r.b^e.b)}function C(e,t){var r=(65535&e)+(65535&t);return((e>>>16)+(t>>>16)+(r>>>16)&65535)<<16|65535&r}function A(e,t,r,n){var o=(65535&e)+(65535&t)+(65535&r)+(65535&n);return((e>>>16)+(t>>>16)+(r>>>16)+(n>>>16)+(o>>>16)&65535)<<16|65535&o}function T(e,t,r,n,o){var i=(65535&e)+(65535&t)+(65535&r)+(65535&n)+(65535&o);return((e>>>16)+(t>>>16)+(r>>>16)+(n>>>16)+(o>>>16)+(i>>>16)&65535)<<16|65535&i}function q(e,t){var r,n,o;return r=(65535&e.b)+(65535&t.b),n=(e.b>>>16)+(t.b>>>16)+(r>>>16),o=(65535&n)<<16|65535&r,r=(65535&e.a)+(65535&t.a)+(n>>>16),n=(e.a>>>16)+(t.a>>>16)+(r>>>16),new s((65535&n)<<16|65535&r,o)}function B(e,t,r,n){var o,i,a;return o=(65535&e.b)+(65535&t.b)+(65535&r.b)+(65535&n.b),i=(e.b>>>16)+(t.b>>>16)+(r.b>>>16)+(n.b>>>16)+(o>>>16),a=(65535&i)<<16|65535&o,o=(65535&e.a)+(65535&t.a)+(65535&r.a)+(65535&n.a)+(i>>>16),i=(e.a>>>16)+(t.a>>>16)+(r.a>>>16)+(n.a>>>16)+(o>>>16),new s((65535&i)<<16|65535&o,a)}function N(e,t,r,n,o){var i,a,u;return i=(65535&e.b)+(65535&t.b)+(65535&r.b)+(65535&n.b)+(65535&o.b),a=(e.b>>>16)+(t.b>>>16)+(r.b>>>16)+(n.b>>>16)+(o.b>>>16)+(i>>>16),u=(65535&a)<<16|65535&i,i=(65535&e.a)+(65535&t.a)+(65535&r.a)+(65535&n.a)+(65535&o.a)+(a>>>16),a=(e.a>>>16)+(t.a>>>16)+(r.a>>>16)+(n.a>>>16)+(o.a>>>16)+(i>>>16),new s((65535&a)<<16|65535&i,u)}function U(e,t){return new s(e.a^t.a,e.b^t.b)}function W(e){var t,r=[];if("SHA-1"===e)r=[1732584193,4023233417,2562383102,271733878,3285377520];else if(0===e.lastIndexOf("SHA-",0))switch(r=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],t=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],e){case"SHA-224":break;case"SHA-256":r=t;break;case"SHA-384":r=[new s(3418070365,r[0]),new s(1654270250,r[1]),new s(2438529370,r[2]),new s(355462360,r[3]),new s(1731405415,r[4]),new s(41048885895,r[5]),new s(3675008525,r[6]),new s(1203062813,r[7])];break;case"SHA-512":r=[new s(t[0],4089235720),new s(t[1],2227873595),new s(t[2],4271175723),new s(t[3],1595750129),new s(t[4],2917565137),new s(t[5],725511199),new s(t[6],4215389547),new s(t[7],327033209)];break;default:throw Error("Unknown SHA variant")}else{if(0!==e.lastIndexOf("SHA3-",0)&&0!==e.lastIndexOf("SHAKE",0))throw Error("No SHA variants supported");for(e=0;5>e;e+=1)r[e]=[new s(0,0),new s(0,0),new s(0,0),new s(0,0),new s(0,0)]}return r}function D(e,t){var r,n,o,i,s,a,u,c=[];for(r=t[0],n=t[1],o=t[2],i=t[3],s=t[4],u=0;80>u;u+=1)c[u]=16>u?e[u]:h(c[u-3]^c[u-8]^c[u-14]^c[u-16],1),a=20>u?T(h(r,5),n&o^~n&i,s,1518500249,c[u]):40>u?T(h(r,5),n^o^i,s,1859775393,c[u]):60>u?T(h(r,5),w(n,o,i),s,2400959708,c[u]):T(h(r,5),n^o^i,s,3395469782,c[u]),s=i,i=o,o=h(n,30),n=r,r=a;return t[0]=C(r,t[0]),t[1]=C(n,t[1]),t[2]=C(o,t[2]),t[3]=C(i,t[3]),t[4]=C(s,t[4]),t}function I(e,t,r,n){var o;for(o=15+(t+65>>>9<<4);e.length<=o;)e.push(0);for(e[t>>>5]|=128<<24-t%32,t+=r,e[o]=4294967295&t,e[o-1]=t/4294967296|0,t=e.length,o=0;o<t;o+=16)n=D(e.slice(o,o+16),n);return n}function L(e,t,r){var n,o,i,a,u,c,f,l,p,h,b,d,y,v,U,W,D,I,L,M,z,F,Y,K=[];if("SHA-224"===r||"SHA-256"===r)h=64,d=1,F=Number,y=C,v=A,U=T,W=P,D=x,I=_,L=S,z=w,M=g,Y=J;else{if("SHA-384"!==r&&"SHA-512"!==r)throw Error("Unexpected error in SHA-2 implementation");h=80,d=2,F=s,y=q,v=B,U=N,W=E,D=j,I=k,L=O,z=R,M=m,Y=H}for(r=t[0],n=t[1],o=t[2],i=t[3],a=t[4],u=t[5],c=t[6],f=t[7],b=0;b<h;b+=1)16>b?(p=b*d,l=e.length<=p?0:e[p],p=e.length<=p+1?0:e[p+1],K[b]=new F(l,p)):K[b]=v(D(K[b-2]),K[b-7],W(K[b-15]),K[b-16]),l=U(f,L(a),M(a,u,c),Y[b],K[b]),p=y(I(r),z(r,n,o)),f=c,c=u,u=a,a=y(i,l),i=o,o=n,n=r,r=y(l,p);return t[0]=y(r,t[0]),t[1]=y(n,t[1]),t[2]=y(o,t[2]),t[3]=y(i,t[3]),t[4]=y(a,t[4]),t[5]=y(u,t[5]),t[6]=y(c,t[6]),t[7]=y(f,t[7]),t}function M(e,t){var r,n,o,i,a=[],u=[];if(null!==e)for(n=0;n<e.length;n+=2)t[(n>>>1)%5][(n>>>1)/5|0]=U(t[(n>>>1)%5][(n>>>1)/5|0],new s(e[n+1],e[n]));for(r=0;24>r;r+=1){for(i=W("SHA3-"),n=0;5>n;n+=1){o=t[n][0];var c=t[n][1],f=t[n][2],l=t[n][3],p=t[n][4];a[n]=new s(o.a^c.a^f.a^l.a^p.a,o.b^c.b^f.b^l.b^p.b)}for(n=0;5>n;n+=1)u[n]=U(a[(n+4)%5],b(a[(n+1)%5],1));for(n=0;5>n;n+=1)for(o=0;5>o;o+=1)t[n][o]=U(t[n][o],u[n]);for(n=0;5>n;n+=1)for(o=0;5>o;o+=1)i[o][(2*n+3*o)%5]=b(t[n][o],z[n][o]);for(n=0;5>n;n+=1)for(o=0;5>o;o+=1)t[n][o]=U(i[n][o],new s(~i[(n+1)%5][o].a&i[(n+2)%5][o].a,~i[(n+1)%5][o].b&i[(n+2)%5][o].b));t[0][0]=U(t[0][0],F[r])}return t}var J,H,z,F;J=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],H=[new s(J[0],3609767458),new s(J[1],602891725),new s(J[2],3964484399),new s(J[3],2173295548),new s(J[4],4081628472),new s(J[5],3053834265),new s(J[6],2937671579),new s(J[7],3664609560),new s(J[8],2734883394),new s(J[9],1164996542),new s(J[10],1323610764),new s(J[11],3590304994),new s(J[12],4068182383),new s(J[13],991336113),new s(J[14],633803317),new s(J[15],3479774868),new s(J[16],2666613458),new s(J[17],944711139),new s(J[18],2341262773),new s(J[19],2007800933),new s(J[20],1495990901),new s(J[21],1856431235),new s(J[22],3175218132),new s(J[23],2198950837),new s(J[24],3999719339),new s(J[25],766784016),new s(J[26],2566594879),new s(J[27],3203337956),new s(J[28],1034457026),new s(J[29],2466948901),new s(J[30],3758326383),new s(J[31],168717936),new s(J[32],1188179964),new s(J[33],1546045734),new s(J[34],1522805485),new s(J[35],2643833823),new s(J[36],2343527390),new s(J[37],1014477480),new s(J[38],1206759142),new s(J[39],344077627),new s(J[40],1290863460),new s(J[41],3158454273),new s(J[42],3505952657),new s(J[43],106217008),new s(J[44],3606008344),new s(J[45],1432725776),new s(J[46],1467031594),new s(J[47],851169720),new s(J[48],3100823752),new s(J[49],1363258195),new s(J[50],3750685593),new s(J[51],3785050280),new s(J[52],3318307427),new s(J[53],3812723403),new s(J[54],2003034995),new s(J[55],3602036899),new s(J[56],1575990012),new s(J[57],1125592928),new s(J[58],2716904306),new s(J[59],442776044),new s(J[60],593698344),new s(J[61],3733110249),new s(J[62],2999351573),new s(J[63],3815920427),new s(3391569614,3928383900),new s(3515267271,566280711),new s(3940187606,3454069534),new s(4118630271,4000239992),new s(116418474,1914138554),new s(174292421,2731055270),new s(289380356,3203993006),new s(460393269,320620315),new s(685471733,587496836),new s(852142971,1086792851),new s(1017036298,365543100),new s(1126000580,2618297676),new s(1288033470,3409855158),new s(1501505948,4234509866),new s(1607167915,987167468),new s(1816402316,1246189591)],F=[new s(0,1),new s(0,32898),new s(2147483648,32906),new s(2147483648,2147516416),new s(0,32907),new s(0,2147483649),new s(2147483648,2147516545),new s(2147483648,32777),new s(0,138),new s(0,136),new s(0,2147516425),new s(0,2147483658),new s(0,2147516555),new s(2147483648,139),new s(2147483648,32905),new s(2147483648,32771),new s(2147483648,32770),new s(2147483648,128),new s(0,32778),new s(2147483648,2147483658),new s(2147483648,2147516545),new s(2147483648,32896),new s(0,2147483649),new s(2147483648,2147516424)],z=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]],void 0!==(n=function(){return i}.call(t,r,t,e))&&(e.exports=n)}()},function(e,t,r){(function(e,n){var o;!function(i){function s(e){throw new RangeError(T[e])}function a(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function u(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),e=e.replace(A,"."),n+a(e.split("."),t).join(".")}function c(e){for(var t,r,n=[],o=0,i=e.length;o<i;)t=e.charCodeAt(o++),t>=55296&&t<=56319&&o<i?(r=e.charCodeAt(o++),56320==(64512&r)?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--)):n.push(t);return n}function f(e){return a(e,function(e){var t="";return e>65535&&(e-=65536,t+=N(e>>>10&1023|55296),e=56320|1023&e),t+=N(e)}).join("")}function l(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:R}function p(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function h(e,t,r){var n=0;for(e=r?B(e/O):e>>1,e+=B(e/t);e>q*k>>1;n+=R)e=B(e/q);return B(n+(q+1)*e/(e+S))}function b(e){var t,r,n,o,i,a,u,c,p,b,d=[],y=e.length,v=0,g=E,m=P;for(r=e.lastIndexOf(x),r<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&s("not-basic"),d.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<y;){for(i=v,a=1,u=R;o>=y&&s("invalid-input"),c=l(e.charCodeAt(o++)),(c>=R||c>B((w-v)/a))&&s("overflow"),v+=c*a,p=u<=m?_:u>=m+k?k:u-m,!(c<p);u+=R)b=R-p,a>B(w/b)&&s("overflow"),a*=b;t=d.length+1,m=h(v-i,t,0==i),B(v/t)>w-g&&s("overflow"),g+=B(v/t),v%=t,d.splice(v++,0,g)}return f(d)}function d(e){var t,r,n,o,i,a,u,f,l,b,d,y,v,g,m,S=[];for(e=c(e),y=e.length,t=E,r=0,i=P,a=0;a<y;++a)(d=e[a])<128&&S.push(N(d));for(n=o=S.length,o&&S.push(x);n<y;){for(u=w,a=0;a<y;++a)(d=e[a])>=t&&d<u&&(u=d);for(v=n+1,u-t>B((w-r)/v)&&s("overflow"),r+=(u-t)*v,t=u,a=0;a<y;++a)if(d=e[a],d<t&&++r>w&&s("overflow"),d==t){for(f=r,l=R;b=l<=i?_:l>=i+k?k:l-i,!(f<b);l+=R)m=f-b,g=R-b,S.push(N(p(b+m%g,0))),f=B(m/g);S.push(N(p(f,0))),i=h(r,v,n==o),r=0,++n}++r,++t}return S.join("")}function y(e){return u(e,function(e){return j.test(e)?b(e.slice(4).toLowerCase()):e})}function v(e){return u(e,function(e){return C.test(e)?"xn--"+d(e):e})}var g=("object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType,"object"==typeof n&&n);var m,w=2147483647,R=36,_=1,k=26,S=38,O=700,P=72,E=128,x="-",j=/^xn--/,C=/[^\x20-\x7E]/,A=/[\x2E\u3002\uFF0E\uFF61]/g,T={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},q=R-_,B=Math.floor,N=String.fromCharCode;m={version:"1.4.1",ucs2:{decode:c,encode:f},decode:b,encode:d,toASCII:v,toUnicode:y},void 0!==(o=function(){return m}.call(t,r,t,e))&&(e.exports=o)}()}).call(t,r(48)(e),r(14))},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,i){t=t||"&",r=r||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var c=e.length;u>0&&c>u&&(c=u);for(var f=0;f<c;++f){var l,p,h,b,d=e[f].replace(a,"%20"),y=d.indexOf(r);y>=0?(l=d.substr(0,y),p=d.substr(y+1)):(l=d,p=""),h=decodeURIComponent(l),b=decodeURIComponent(p),n(s,h)?o(s[h])?s[h].push(b):s[h]=[s[h],b]:s[h]=b}return s};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";function n(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var o=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,a){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?n(s(e),function(s){var a=encodeURIComponent(o(s))+r;return i(e[s])?n(e[s],function(e){return a+encodeURIComponent(o(e))}).join(t):a+encodeURIComponent(o(e[s]))}).join(t):a?encodeURIComponent(o(a))+r+encodeURIComponent(o(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},function(e,t,r){"use strict";t.decode=t.parse=r(40),t.encode=t.stringify=r(41)},function(e,t,r){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(e,t,r){if(e&&c.isObject(e)&&e instanceof n)return e;var o=new n;return o.parse(e,t,r),o}function i(e){return c.isString(e)&&(e=o(e)),e instanceof n?e.format():n.prototype.format.call(e)}function s(e,t){return o(e,!1,!0).resolve(t)}function a(e,t){return e?o(e,!1,!0).resolveObject(t):t}var u=r(39),c=r(44);t.parse=o,t.resolve=s,t.resolveObject=a,t.format=i,t.Url=n;var f=/^([a-z0-9.+-]+:)/i,l=/:[0-9]*$/,p=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["<",">",'"',"`"," ","\r","\n","\t"],b=["{","}","|","\\","^","`"].concat(h),d=["'"].concat(b),y=["%","/","?",";","#"].concat(d),v=["/","?","#"],g=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,w={javascript:!0,"javascript:":!0},R={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},k=r(42);n.prototype.parse=function(e,t,r){if(!c.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e.indexOf("?"),o=-1!==n&&n<e.indexOf("#")?"?":"#",i=e.split(o),s=/\\/g;i[0]=i[0].replace(s,"/"),e=i.join(o);var a=e;if(a=a.trim(),!r&&1===e.split("#").length){var l=p.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],this.query=t?k.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=f.exec(a);if(h){h=h[0];var b=h.toLowerCase();this.protocol=b,a=a.substr(h.length)}if(r||h||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===a.substr(0,2);!S||h&&R[h]||(a=a.substr(2),this.slashes=!0)}if(!R[h]&&(S||h&&!_[h])){for(var O=-1,P=0;P<v.length;P++){var E=a.indexOf(v[P]);-1!==E&&(-1===O||E<O)&&(O=E)}var x,j;j=-1===O?a.lastIndexOf("@"):a.lastIndexOf("@",O),-1!==j&&(x=a.slice(0,j),a=a.slice(j+1),this.auth=decodeURIComponent(x)),O=-1;for(var P=0;P<y.length;P++){var E=a.indexOf(y[P]);-1!==E&&(-1===O||E<O)&&(O=E)}-1===O&&(O=a.length),this.host=a.slice(0,O),a=a.slice(O),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var A=this.hostname.split(/\./),P=0,T=A.length;P<T;P++){var q=A[P];if(q&&!q.match(g)){for(var B="",N=0,U=q.length;N<U;N++)q.charCodeAt(N)>127?B+="x":B+=q[N];if(!B.match(g)){var W=A.slice(0,P),D=A.slice(P+1),I=q.match(m);I&&(W.push(I[1]),D.unshift(I[2])),D.length&&(a="/"+D.join(".")+a),this.hostname=W.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=u.toASCII(this.hostname));var L=this.port?":"+this.port:"",M=this.hostname||"";this.host=M+L,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!w[b])for(var P=0,T=d.length;P<T;P++){var J=d[P];if(-1!==a.indexOf(J)){var H=encodeURIComponent(J);H===J&&(H=escape(J)),a=a.split(J).join(H)}}var z=a.indexOf("#");-1!==z&&(this.hash=a.substr(z),a=a.slice(0,z));var F=a.indexOf("?");if(-1!==F?(this.search=a.substr(F),this.query=a.substr(F+1),t&&(this.query=k.parse(this.query)),a=a.slice(0,F)):t&&(this.search="",this.query={}),a&&(this.pathname=a),_[b]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",Y=this.search||"";this.path=L+Y}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&c.isObject(this.query)&&Object.keys(this.query).length&&(i=k.stringify(this.query));var s=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||_[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+o+r+s+n},n.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if(c.isString(e)){var t=new n;t.parse(e,!1,!0),e=t}for(var r=new n,o=Object.keys(this),i=0;i<o.length;i++){var s=o[i];r[s]=this[s]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),u=0;u<a.length;u++){var f=a[u];"protocol"!==f&&(r[f]=e[f])}return _[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!_[e.protocol]){for(var l=Object.keys(e),p=0;p<l.length;p++){var h=l[p];r[h]=e[h]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||R[e.protocol])r.pathname=e.pathname;else{for(var b=(e.pathname||"").split("/");b.length&&!(e.host=b.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==b[0]&&b.unshift(""),b.length<2&&b.unshift(""),r.pathname=b.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var d=r.pathname||"",y=r.search||"";r.path=d+y}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var v=r.pathname&&"/"===r.pathname.charAt(0),g=e.host||e.pathname&&"/"===e.pathname.charAt(0),m=g||v||r.host&&e.pathname,w=m,k=r.pathname&&r.pathname.split("/")||[],b=e.pathname&&e.pathname.split("/")||[],S=r.protocol&&!_[r.protocol];if(S&&(r.hostname="",r.port=null,r.host&&(""===k[0]?k[0]=r.host:k.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===b[0]?b[0]=e.host:b.unshift(e.host)),e.host=null),m=m&&(""===b[0]||""===k[0])),g)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,k=b;else if(b.length)k||(k=[]),k.pop(),k=k.concat(b),r.search=e.search,r.query=e.query;else if(!c.isNullOrUndefined(e.search)){if(S){r.hostname=r.host=k.shift();var O=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");O&&(r.auth=O.shift(),r.host=r.hostname=O.shift())}return r.search=e.search,r.query=e.query,c.isNull(r.pathname)&&c.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!k.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var P=k.slice(-1)[0],E=(r.host||e.host||k.length>1)&&("."===P||".."===P)||""===P,x=0,j=k.length;j>=0;j--)P=k[j],"."===P?k.splice(j,1):".."===P?(k.splice(j,1),x++):x&&(k.splice(j,1),x--);if(!m&&!w)for(;x--;x)k.unshift("..");!m||""===k[0]||k[0]&&"/"===k[0].charAt(0)||k.unshift(""),E&&"/"!==k.join("/").substr(-1)&&k.push("");var C=""===k[0]||k[0]&&"/"===k[0].charAt(0);if(S){r.hostname=r.host=C?"":k.length?k.shift():"";var O=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");O&&(r.auth=O.shift(),r.host=r.hostname=O.shift())}return m=m||r.host&&k.length,m&&!C&&k.unshift(""),k.length?r.pathname=k.join("/"):(r.pathname=null,r.path=null),c.isNull(r.pathname)&&c.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var e=this.host,t=l.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t,r){(function(e,n){function o(e,r){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(r)?n.showHidden=r:r&&t._extend(n,r),R(n.showHidden)&&(n.showHidden=!1),R(n.depth)&&(n.depth=2),R(n.colors)&&(n.colors=!1),R(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=i),u(n,e,n.depth)}function i(e,t){var r=o.styles[t];return r?"["+o.colors[r][0]+"m"+e+"["+o.colors[r][1]+"m":e}function s(e,t){return e}function a(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function u(e,r,n){if(e.customInspect&&r&&P(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return m(o)||(o=u(e,o,n)),o}var i=c(e,r);if(i)return i;var s=Object.keys(r),d=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(r)),O(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(r);if(0===s.length){if(P(r)){var y=r.name?": "+r.name:"";return e.stylize("[Function"+y+"]","special")}if(_(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(S(r))return e.stylize(Date.prototype.toString.call(r),"date");if(O(r))return f(r)}var v="",g=!1,w=["{","}"];if(b(r)&&(g=!0,w=["[","]"]),P(r)){v=" [Function"+(r.name?": "+r.name:"")+"]"}if(_(r)&&(v=" "+RegExp.prototype.toString.call(r)),S(r)&&(v=" "+Date.prototype.toUTCString.call(r)),O(r)&&(v=" "+f(r)),0===s.length&&(!g||0==r.length))return w[0]+v+w[1];if(n<0)return _(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special");e.seen.push(r);var R;return R=g?l(e,r,n,d,s):s.map(function(t){return p(e,r,n,d,t,g)}),e.seen.pop(),h(R,v,w)}function c(e,t){if(R(t))return e.stylize("undefined","undefined");if(m(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return g(t)?e.stylize(""+t,"number"):d(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function l(e,t,r,n,o){for(var i=[],s=0,a=t.length;s<a;++s)A(t,String(s))?i.push(p(e,t,r,n,String(s),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(p(e,t,r,n,o,!0))}),i}function p(e,t,r,n,o,i){var s,a,c;if(c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},c.get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),A(n,o)||(s="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=y(r)?u(e,c.value,null):u(e,c.value,r-1),a.indexOf("\n")>-1&&(a=i?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),R(s)){if(i&&o.match(/^\d+$/))return a;s=JSON.stringify(""+o),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function h(e,t,r){var n=0;return e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function b(e){return Array.isArray(e)}function d(e){return"boolean"==typeof e}function y(e){return null===e}function v(e){return null==e}function g(e){return"number"==typeof e}function m(e){return"string"==typeof e}function w(e){return"symbol"==typeof e}function R(e){return void 0===e}function _(e){return k(e)&&"[object RegExp]"===x(e)}function k(e){return"object"==typeof e&&null!==e}function S(e){return k(e)&&"[object Date]"===x(e)}function O(e){return k(e)&&("[object Error]"===x(e)||e instanceof Error)}function P(e){return"function"==typeof e}function E(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function x(e){return Object.prototype.toString.call(e)}function j(e){return e<10?"0"+e.toString(10):e.toString(10)}function C(){var e=new Date,t=[j(e.getHours()),j(e.getMinutes()),j(e.getSeconds())].join(":");return[e.getDate(),N[e.getMonth()],t].join(" ")}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var T=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(o(arguments[r]));return t.join(" ")}for(var r=1,n=arguments,i=n.length,s=String(e).replace(T,function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),a=n[r];r<i;a=n[++r])y(a)||!k(a)?s+=" "+a:s+=" "+o(a);return s},t.deprecate=function(r,o){function i(){if(!s){if(n.throwDeprecation)throw new Error(o);n.traceDeprecation?console.trace(o):console.error(o),s=!0}return r.apply(this,arguments)}if(R(e.process))return function(){return t.deprecate(r,o).apply(this,arguments)};if(!0===n.noDeprecation)return r;var s=!1;return i};var q,B={};t.debuglog=function(e){if(R(q)&&(q=r.i({NODE_ENV:"production"}).NODE_DEBUG||""),e=e.toUpperCase(),!B[e])if(new RegExp("\\b"+e+"\\b","i").test(q)){var o=n.pid;B[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,o,r)}}else B[e]=function(){};return B[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=b,t.isBoolean=d,t.isNull=y,t.isNullOrUndefined=v,t.isNumber=g,t.isString=m,t.isSymbol=w,t.isUndefined=R,t.isRegExp=_,t.isObject=k,t.isDate=S,t.isError=O,t.isFunction=P,t.isPrimitive=E,t.isBuffer=r(46);var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",C(),t.format.apply(t,arguments))},t.inherits=r(45),t._extend=function(e,t){if(!t||!k(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(t,r(14),r(3))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){},function(e,t,r){e.exports=r(17)}])});
//# sourceMappingURL=jsonrpc.min.js.map